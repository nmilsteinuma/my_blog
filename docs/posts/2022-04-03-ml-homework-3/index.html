<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Noah Milstein DACSS Blog: ML homework 3</title>

<meta property="description" itemprop="description" content="A short description of the post."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-04-03"/>
<meta property="article:created" itemprop="dateCreated" content="2022-04-03"/>
<meta name="article:author" content="Noah Milstein"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Noah Milstein DACSS Blog: ML homework 3"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A short description of the post."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Noah Milstein DACSS Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Noah Milstein DACSS Blog: ML homework 3"/>
<meta property="twitter:description" content="A short description of the post."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["ML homework 3"]},{"type":"character","attributes":{},"value":["A short description of the post."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Noah Milstein"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2022-04-03"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["ml-homework-3_files/anchor-4.2.2/anchor.min.js","ml-homework-3_files/bowser-1.9.3/bowser.min.js","ml-homework-3_files/distill-2.2.21/template.v2.js","ml-homework-3_files/figure-html5/unnamed-chunk-104-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-105-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-106-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-110-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-112-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-115-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-129-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-13-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-130-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-131-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-135-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-14-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-20-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-25-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-27-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-28-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-31-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-58-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-63-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-64-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-68-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-71-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-79-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-80-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-81-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-85-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-87-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-9-1.png","ml-homework-3_files/figure-html5/unnamed-chunk-90-1.png","ml-homework-3_files/header-attrs-2.13/header-attrs.js","ml-homework-3_files/jquery-3.6.0/jquery-3.6.0.js","ml-homework-3_files/jquery-3.6.0/jquery-3.6.0.min.js","ml-homework-3_files/jquery-3.6.0/jquery-3.6.0.min.map","ml-homework-3_files/popper-2.6.0/popper.min.js","ml-homework-3_files/tippy-6.2.7/tippy-bundle.umd.min.js","ml-homework-3_files/tippy-6.2.7/tippy-light-border.css","ml-homework-3_files/tippy-6.2.7/tippy.css","ml-homework-3_files/tippy-6.2.7/tippy.umd.min.js","ml-homework-3_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.13/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"ML homework 3","description":"A short description of the post.","authors":[{"author":"Noah Milstein","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-04-03T00:00:00.000-04:00","citationText":"Milstein, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Noah Milstein DACSS Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>ML homework 3</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A short description of the post.</p></p>
</div>

<div class="d-byline">
  Noah Milstein true 
  
<br/>2022-04-03
</div>

<div class="d-article">
<p>ISLR Ch. 12, Exercise 9</p>
<p>ISLR Ch. 12, Exercise 10</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="problem-set-3">Problem Set 3</h2>
<h3 id="ch.-6">Ch. 6</h3>
<p><strong>Basis:</strong> In this exercise, we will predict the number
of applications received using the other variables in the College data
set. During my original calculations for homework 2 I did the prediction
on the graduation rate rather than applications received so I will be
modifying my calculations for parts a through e to reflect this and
enable me to interpret part g correctly.</p>
<h4 id="a">(a)</h4>
<p><strong>Question:</strong> Split the data set into a training set and
a test set.</p>
<p><strong>Answer:</strong> I split the data into training and test set
using 1 through the number of rows in the dataset and sampling it
nrow(College)*0.8 times which works out to taking 621.6 row samples with
replacement equals FALSE, this equates to and 80%, 20% split in the
training and test sets. I specify the college_training as the 80% of
College data I specified as my training. Next I find the test set using
the converse of the training rows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>train_College_numbers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>College</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>College</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.8</span>,
                                replace <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>college_training</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>[</span><span class='va'>train_College_numbers</span>,<span class='op'>]</span>

<span class='va'>college_test</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train_College_numbers</span>,<span class='op'>]</span>
</code></pre>
</div>
</div>
<h4 id="b">(b)</h4>
<p><strong>Question:</strong> Fit a linear model using least squares on
the training set, and report the test error obtained.</p>
<p><strong>Fitting Linear Model on training set:</strong> I fit a least
squares on my 80% training set below using all variables since we will
be using a ridge regression that later account for the number of
variables we should use as the ridge moves their coefficients towards
zero. In this first regression least_squares_college all will be
included</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>least_squares_college</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>Apps</span> <span class='op'>~</span><span class='va'>.</span> , data<span class='op'>=</span><span class='va'>college_training</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>least_squares_college</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = Apps ~ ., data = college_training)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5287.0   -456.8    -34.7    322.6   7398.0  

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -416.89986  457.22350  -0.912 0.362234    
PrivateYes  -515.16038  153.53918  -3.355 0.000843 ***
Accept         1.67719    0.04490  37.352  &lt; 2e-16 ***
Enroll        -1.15195    0.20131  -5.722 1.66e-08 ***
Top10perc     51.69387    6.28993   8.219 1.26e-15 ***
Top25perc    -14.75725    5.00799  -2.947 0.003335 ** 
F.Undergrad    0.06373    0.03504   1.818 0.069486 .  
P.Undergrad    0.06392    0.03448   1.854 0.064285 .  
Outstate      -0.08220    0.02129  -3.862 0.000125 ***
Room.Board     0.12714    0.05301   2.398 0.016781 *  
Books          0.19778    0.26659   0.742 0.458431    
Personal       0.02882    0.06946   0.415 0.678341    
PhD          -10.03409    5.28070  -1.900 0.057891 .  
Terminal      -1.63473    5.71321  -0.286 0.774876    
S.F.Ratio     14.00498   15.50514   0.903 0.366755    
perc.alumni    1.14932    4.64636   0.247 0.804715    
Expend         0.06620    0.01426   4.642 4.24e-06 ***
Grad.Rate      8.80380    3.38925   2.598 0.009618 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 1095060)

    Null deviance: 9396783054  on 620  degrees of freedom
Residual deviance:  660321185  on 603  degrees of freedom
AIC: 10418

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<p><strong>Obtaining Test MSE:</strong> In order to obtain test error I
use the predict function and the least_squares_college linear model in
my previous code and apply it to my test data. I report test error as
Mean Squared error which is calculated below as the difference between
the true value of the number of applications minus the predicted number,
squared. I obtain a result of 1,094,646 as my MSE.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>pred_college_for_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>least_squares_college</span>, newdata<span class='op'>=</span><span class='va'>college_test</span><span class='op'>)</span>

<span class='va'>MSE_college_test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>college_test</span><span class='op'>$</span><span class='va'>Apps</span><span class='op'>-</span><span class='va'>pred_college_for_mse</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>

<span class='va'>MSE_college_test</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1094646</td>
</tr>
</tbody>
</table>
</div>
<h4 id="c">(c)</h4>
<p><strong>Question:</strong> Fit a ridge regression model on the
training set, with lambda chosen by cross-validation. Report the test
error obtained.</p>
<p><strong>Answer:</strong> Below I make a grid of values that is a
sequence of 10 to -2 of length 100 which goes from 10^10 to 10^(-2) and
creates a set of selected values. In order to fit a ridge model using
cross validation I split the model into training and test set. Using the
glmnet() function I then plug in my x-ridge model matrix and the y-ridge
being the true values from the graduation rate column of the college
dataset. This results in a dimension of 18 by 100.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>x_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>Apps</span> <span class='op'>~</span> <span class='va'>.</span>, <span class='va'>College</span><span class='op'>)</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> 

<span class='va'>y_ridge</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>$</span><span class='va'>Apps</span>

<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'>glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span>, <span class='va'>y_ridge</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ridge.mod</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  18 100</code></pre>
</div>
<p><strong>Answer:</strong> Below I then split my data into an 80% 20%
split between training and test sets. These values are stored in the
train_ridge and test_ridge variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>train_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.8</span> <span class='op'>)</span> 

<span class='va'>test_ridge</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>train_ridge</span><span class='op'>)</span>

<span class='va'>y.test_ridge</span> <span class='op'>&lt;-</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<p><strong>Answer:</strong> I then use the glmnet() function with an
alpha of 0 which is a ridge penalty in this case. In this scenario the
function is named ridge.mod, this is then put into predict() where it
predicts on the test section of the data. The resulting mean squared
error is 1,082,823 which is a 11,823 unit improvement over the original
GLM with no variable coefficinets moved towards zero.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'>glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span>, thresh <span class='op'>=</span> <span class='fl'>1e-12</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>4</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1082823</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Answer:</strong> Afterwards we fit the model again using the
glmnet() function ridge.mod using a new x from x_ridge and our x and y
from training. We then access the 18 coefficients below, as can be seen
the ridge moves the coefficients it decides have little impact towards
zero.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>0</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>, <span class='op'>]</span>, 
                      exact <span class='op'>=</span> <span class='cn'>T</span>, x <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, 
                      y <span class='op'>=</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>0</span>, exact <span class='op'>=</span> <span class='cn'>T</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, 
        x <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>18</span>, <span class='op'>]</span>
</code></pre>
</div>
<pre><code>  (Intercept)    PrivateYes        Accept        Enroll     Top10perc 
-416.91598640 -515.16078508    1.67718327   -1.15190837   51.69345986 
    Top25perc   F.Undergrad   P.Undergrad      Outstate    Room.Board 
 -14.75698190    0.06372381    0.06391797   -0.08220220    0.12713933 
        Books      Personal           PhD      Terminal     S.F.Ratio 
   0.19778375    0.02881838  -10.03405966   -1.63474983   14.00500428 
  perc.alumni        Expend     Grad.Rate 
   1.14916782    0.06620367    8.80384229 </code></pre>
</div>
<p><strong>Answer continued:</strong> Next after beginning these tests
we use cross validation to get the optimal tuning parameters from a
number of repetitions using cv.glmnet() in this case it takes our
training values and an alpha of zero to indicate it is a ridge and uses
a number of values of lambda to determine which minimizes mean squared
errors. This is plotted below</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'>cv.glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p><strong>Answer continued:</strong> The cv.out we calculated above
outputs a 1se and min lambda for its mean square errors which I access
below to determine the cross validated tuning parameter.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>bestlam</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>

<span class='va'>bestlam</span>
</code></pre>
</div>
<pre><code>[1] 367.1318</code></pre>
</div>
<p><strong>Answer continued:</strong> Finally we use out predict
function to see what our mean squared error will be for our tuning
parameters than minimizes MSE, in this case it is <em>924,234.4</em> as
seen below compared to the grid values which yielded a
<em>1,082,823</em> at best.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv.out</span>, s <span class='op'>=</span> <span class='va'>bestlam</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">924234.4</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Answer continued:</strong> The coefficient outputs for the
lambda that minimizes MSE are then expressed below. Here a number of
coefficients remain in the function when predicting the number of
applications received using a ridge regression.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>out</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, s <span class='op'>=</span> <span class='va'>bestlam</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>18</span>, <span class='op'>]</span>
</code></pre>
</div>
<pre><code>  (Intercept)    PrivateYes        Accept        Enroll     Top10perc 
-1.430977e+03 -5.496801e+02  1.057014e+00  3.353268e-01  2.631621e+01 
    Top25perc   F.Undergrad   P.Undergrad      Outstate    Room.Board 
 2.162225e-01  6.242687e-02  4.495189e-02 -2.214940e-02  1.867657e-01 
        Books      Personal           PhD      Terminal     S.F.Ratio 
 2.235599e-01 -4.416771e-03 -4.635434e+00 -3.857974e+00  1.069120e+01 
  perc.alumni        Expend     Grad.Rate 
-6.993849e+00  6.707918e-02  1.128735e+01 </code></pre>
</div>
<h4 id="d">(d)</h4>
<p><strong>Question:</strong> Fit a lasso model on the training set,
with lambda chosen by cross validation. Report the test error obtained,
along with the number of non-zero coefficient estimates.</p>
<p><strong>Answer:</strong> The process of creating the lasso is largely
similar to that of the ridge though here our initial glmnet() takes an
alpha of 1. The plot below this indicates that depending on our choice
of tuning parameter lambda, certain coefficients will become zero.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'>glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso.mod</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p><strong>Answer continued:</strong> We continue this analysis by cross
validation using cv.glmnet() with an alpha of 1 to find the coefficients
that again, minimize the MSE.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>cv.out_2</span> <span class='op'>&lt;-</span> <span class='fu'>cv.glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p><strong>Answer continued:</strong> After this cross validation has
been calculated we then access the lambda that minimizes MSE. We then
use the predict function to calculate predictions for our lasso using
the lambda that minimizes MSE this gets a MSE of <em>1,082,717</em>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>bestlam</span> <span class='op'>&lt;-</span> <span class='va'>cv.out_2</span><span class='op'>$</span><span class='va'>lambda.min</span>

<span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv.out_2</span>, s <span class='op'>=</span> <span class='va'>bestlam</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1082717</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Answer continued:</strong> Finally we calculate and show the
coefficients for our equation with the lasso reducing our number of
parameters by moving coefficients towards zero that have low
impacts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>glmnet</span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, 
              alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='va'>lasso.coef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>out</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, s <span class='op'>=</span> <span class='va'>bestlam</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>18</span>, <span class='op'>]</span>

<span class='va'>lasso.coef</span>
</code></pre>
</div>
<pre><code>  (Intercept)    PrivateYes        Accept        Enroll     Top10perc 
-436.97702003 -509.30206039    1.66235527   -1.04564674   50.11691793 
    Top25perc   F.Undergrad   P.Undergrad      Outstate    Room.Board 
 -13.46352450    0.05004629    0.06386337   -0.07961429    0.12494655 
        Books      Personal           PhD      Terminal     S.F.Ratio 
   0.19037707    0.02565307   -9.86601233   -1.42155634   13.00502224 
  perc.alumni        Expend     Grad.Rate 
   0.44253226    0.06559830    8.53311793 </code></pre>
</div>
<h3 id="g">(g)</h3>
<p><strong>Basis:</strong> Comment on the results obtained. How
accurately can we predict the number of college applications received?
Is there much difference among the test errors resulting from these five
approaches?</p>
<p><strong>Answer:</strong> The results are relatively similar across
the 3 models. Mean squared errors are close to a million with some
methods improving by about 10,000 though still making quite high MSE. No
method appears to significantly alter the results of the regression with
lasso not appearing to move any coefficients towards zero and drop the
impact of any particular variaable.</p>
<h3 id="ch.-12-exercise-8">Ch. 12, Exercise 8</h3>
<p><strong>Basis:</strong> In Section 12.2.3, a formula for calculating
PVE was given in Equation 12.10. We also saw that the PVE can be
obtained using the sdev output of the prcomp() function. On the
USArrests data, calculate PVE in two ways:</p>
<h4 id="part-a">Part (a)</h4>
<p><strong>Basis:</strong> Using the sdev output of the prcomp()
function, as was done in Section 12.2.3.</p>
<p><strong>Answer:</strong> Using sdev and prcomp() on USA arrests on
USArrests as in 12.2.3 we first start by using our principal component
function prcomp(), inside of this we add USArrests and scale our
variables for consistency. These princpal components are represented by
pr.out</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>USArrests</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>pr.out</span>
</code></pre>
</div>
<pre><code>Standard deviations (1, .., p=4):
[1] 1.5748783 0.9948694 0.5971291 0.4164494

Rotation (n x k) = (4 x 4):
                PC1        PC2        PC3         PC4
Murder   -0.5358995  0.4181809 -0.3412327  0.64922780
Assault  -0.5831836  0.1879856 -0.2681484 -0.74340748
UrbanPop -0.2781909 -0.8728062 -0.3780158  0.13387773
Rape     -0.5434321 -0.1673186  0.8177779  0.08902432</code></pre>
</div>
<p><strong>Answer 2:</strong> Next we see 4 names in the output of our
principal component function results, one of which is sdev which will
need to calculate our PVE.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 50  4</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p><strong>Answer 3:</strong> We see our 4 sdev, or standard deviations
for Murder, Assault, UrbanPop and Rape.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.5748783</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9948694</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5971291</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4164494</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Answer 4:</strong> First we square our sdevs to acquire our
variance.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var</span> <span class='op'>&lt;-</span> <span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var</span>
</code></pre>
</div>
<pre><code>[1] 2.4802416 0.9897652 0.3565632 0.1734301</code></pre>
</div>
<p><strong>Answer 5:</strong> Next we divide these values of our
variance by their sum in the denominator.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve</span> <span class='op'>&lt;-</span> <span class='va'>pr.var</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var</span><span class='op'>)</span>

<span class='va'>pve</span>
</code></pre>
</div>
<pre><code>[1] 0.62006039 0.24744129 0.08914080 0.04335752</code></pre>
</div>
<h4 id="b-1">(b)</h4>
<p><strong>Basis:</strong> By applying Equation 12.10 directly. That is,
use the prcomp() function to compute the principal component loadings.
Then, use those loadings in Equation 12.10 to obtain the PVE.</p>
<p><strong>Answer:</strong> In order to obtain PVE directly we must
first obtain our loadings using prcomp, which I caclualted earlier as
pr.out &lt;- prcomp(USArrests, scale = TRUE). The loadings are
represented as the rotations of the principal component. I then multiply
these by the matrix of scaled USArrests observations which have each
state represented with each of the 4 variables, Using matrix
multiplication on the USArrests data and loadings we have the first
part of the top of 12.10, this is then squared and summed. This is then
divided by the sum of the previously calculated squared matrix
multipliation. This results in identical PVEs to those obtained by code
alone.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>USArrests_scaled</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>USArrests</span><span class='op'>)</span>

<span class='co'>#dim(USArrests_scaled)</span>

<span class='va'>loadings</span> <span class='op'>&lt;-</span> <span class='va'>pr.out</span><span class='op'>$</span><span class='va'>rotation</span>

<span class='co'># dim(loadings)</span>


<span class='va'>loadings_times_var</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>USArrests_scaled</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>loadings</span><span class='op'>)</span>

<span class='va'>sum_squares</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>loadings_times_var</span><span class='op'>^</span><span class='fl'>2</span>, <span class='fl'>2</span>, <span class='va'>sum</span><span class='op'>)</span>

<span class='va'>sum_squares</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sum_squares</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       PC1        PC2        PC3        PC4 
0.62006039 0.24744129 0.08914080 0.04335752 </code></pre>
</div>
<h3 id="ch.-12-exercise-9">Ch. 12, Exercise 9</h3>
<p><strong>Basis:</strong> Consider the USArrests data. We will now
perform hierarchical clustering on the states.</p>
<h4 id="a-1">(a)</h4>
<p><strong>Basis:</strong> Using hierarchical clustering with complete
linkage and Euclidean distance, cluster the states.</p>
<p><strong>Answer:</strong> Below I use hierarchical clustering on the
US states, this is done using the dist() function between states in the
USArrests matrix, by default this uses eucliean distance, no diagonal or
upper portion of the data which would repeat the values below the matrix
diagonal. Next I use hclust() which performs hierarchical clustering
with complete linkage.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># First dist() is used on USArrests to compute euclidean </span>
<span class='co'># distance between the observations in each state.</span>

<span class='va'>USArrests.dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>USArrests</span><span class='op'>)</span>

<span class='co'># Next I acquire the labels from the dendrogram graph using the labels</span>
<span class='co'># From USArrests</span>
<span class='va'>USArrest.labs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>USArrests</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>USArrests.dist</span>, method<span class='op'>=</span><span class='st'>"complete"</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, 
     sub <span class='op'>=</span> <span class='st'>""</span>, ylab <span class='op'>=</span> <span class='st'>""</span>, main <span class='op'>=</span> <span class='st'>"Complete Linkage"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<h4 id="b-2">(b)</h4>
<p><strong>Basis:</strong> Cut the dendrogram at a height that results
in three distinct clusters. Which states belong to which clusters?</p>
<p><strong>Answer:</strong> Below I have used the function cutree, which
cuts a tree specified in an hclust() into a spcified number of groups,
in this case 3. After running this function I manually extract the rows
from the table that represent state membership into each group with
having a 1, as opposed to a zero in that group representing that the
observation belongs to it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>8437</span><span class='op'>)</span>

<span class='co'># First I use clust() on our USArrests euclidean distance with complete linkage</span>
<span class='co'># Next I use cutree() to cut the USArrests.dist data into 3 clusters.</span>

<span class='va'>hc.clusters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>USArrests.dist</span>, method<span class='op'>=</span><span class='st'>"complete"</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>

<span class='co'># I then add these to a table with each observations repective label</span>

<span class='va'>table_with_3_clusters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>hc.clusters</span>, <span class='va'>USArrest.labs</span><span class='op'>)</span>

<span class='co'># I then take all 3 rows on their own</span>

<span class='va'>table_with_3_clusters_r1</span> <span class='op'>&lt;-</span> <span class='va'>table_with_3_clusters</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span>

<span class='va'>table_with_3_clusters_r2</span> <span class='op'>&lt;-</span> <span class='va'>table_with_3_clusters</span><span class='op'>[</span><span class='fl'>2</span>,<span class='op'>]</span>

<span class='va'>table_with_3_clusters_r3</span> <span class='op'>&lt;-</span> <span class='va'>table_with_3_clusters</span><span class='op'>[</span><span class='fl'>3</span>,<span class='op'>]</span>

<span class='co'># I finally take these rows and find when they are eqivalent to one since </span>
<span class='co'># each row is a group and 1 indicates the state belongs to it.</span>

<span class='va'>table_with_3_clusters_r1</span><span class='op'>[</span><span class='va'>table_with_3_clusters_r1</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alabama</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alaska</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Arizona</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">California</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delaware</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Florida</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Illinois</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Louisiana</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maryland</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Michigan</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mississippi</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nevada</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">New Mexico</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">New York</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North Carolina</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Carolina</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table_with_3_clusters_r2</span><span class='op'>[</span><span class='va'>table_with_3_clusters_r2</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arkansas</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Colorado</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Georgia</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Massachusetts</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Missouri</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Jersey</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oklahoma</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oregon</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rhode Island</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tennessee</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Texas</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Virginia</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Washington</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wyoming</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>table_with_3_clusters_r3</span><span class='op'>[</span><span class='va'>table_with_3_clusters_r3</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Connecticut</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hawaii</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Idaho</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indiana</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iowa</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kansas</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kentucky</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maine</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Minnesota</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Montana</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nebraska</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Hampshire</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North Dakota</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ohio</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pennsylvania</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Dakota</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Utah</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vermont</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">West Virginia</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wisconsin</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Answer 2:</strong> I then plot the results below using a red
line at a level which creates 3 groups.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>USArrests.dist</span>, method<span class='op'>=</span><span class='st'>"complete"</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='va'>USArrest.labs</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='fl'>100</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<h4 id="c-1">(c)</h4>
<p><strong>Basis:</strong> Hierarchically cluster the states using
complete linkage and Euclidean distance, after scaling the variables to
have standard deviation one.</p>
<p><strong>Answer:</strong> In this problem I follow largely the same as
before with the exception of the scaling of the USArrests data to have a
mean of 0 and a standard deviation of 1. This is first done with the
scale() function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>213</span><span class='op'>)</span>

<span class='co'># First I use the scale function to scale the observations to the std of 1 </span>
<span class='co'># and mean of zero this is done with scale()</span>

<span class='va'>USArrests_scaled_c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>USArrests</span><span class='op'>)</span>
 
<span class='co'># Next I compute the distance with dist() specifying that it will be using</span>
<span class='co'># The euclidean method, though this is the default.</span>

<span class='va'>USArrests_scaled_c.dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>USArrests_scaled_c</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span> <span class='op'>)</span>

<span class='co'># Next I find labels using the rownames from the dataset.</span>

<span class='va'>USArrests_scaled.labs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>USArrests_scaled_c</span><span class='op'>)</span>

<span class='co'># Finally I use the hclust() function to apply hierarchical clustering to the </span>
<span class='co'># data, in this case using complete clustering.</span>

<span class='va'>hclust_USArrests_scaled_c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>USArrests_scaled_c.dist</span>, method<span class='op'>=</span><span class='st'>"complete"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>hclust_USArrests_scaled_c</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, sub <span class='op'>=</span> <span class='st'>""</span>, ylab <span class='op'>=</span> <span class='st'>""</span>,
labels <span class='op'>=</span> <span class='va'>USArrests_scaled.labs</span>, main <span class='op'>=</span> <span class='st'>"Complete Linkage"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<h4 id="d-1">(d)</h4>
<p><strong>Basis:</strong> What effect does scaling the variables have
on the hierarchical clustering obtained? In your opinion, should the
variables be scaled before the inter-observation dissimilarities are
computed? Provide a justification for your answer.</p>
<p><strong>Answer:</strong> Scaling the variables breaks them into far
more small clusters and likely distinguishes them more closely at more
levels. This is likely as distinguishing between groups will be based on
a common scale that reduces possible scale differences within the
dataset. As a result of this I would argue that scaling is beneficial,
though the data is per 100,000 residents so it is scaled to some extent,
certain states have far higher density and population so the meaning of
per-100,000 can have differing impact. Though it likely helps to have
all variables on the same scale it is not as useful as it would be in a
scenario with variables using a different basis of measurement from one
another, such as total deaths and deaths per-100,000 residents, or
percent of violent crimes in the state. I</p>
<h3 id="ch.-12-exercise-10">Ch. 12, Exercise 10</h3>
<p><strong>Basis:</strong> In this problem, you will generate simulated
data, and then perform PCA and K-means clustering on the data.</p>
<h4 id="a-2">(a)</h4>
<p><strong>Basis:</strong> Generate a simulated data set with 20
observations in each of three classes (i.e.60 observations total), and
50 variables.</p>
<p>Hint: There are a number of functions in R that you can use to
generate data. One example is the rnorm() function; runif() is another
option. Be sure to add a mean shift to the observations in each class so
that there are three distinct classes.</p>
<p><strong>Answer:</strong> In order to generate 20 observations of 3
classes I used the code and random generation functions below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>280</span><span class='op'>)</span>


<span class='co'># First I take an rnorm with 20 observation and 3 different means</span>

<span class='co'># and 3 different standard deviations to observe the effect of this</span>

<span class='co'># In generating principal components, I then use replicate to run this</span>

<span class='co'># simulation for 50 variables so it is replacted 50 times</span>

<span class='va'>df_1_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>20</span>, mean<span class='op'>=</span><span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>df_1_10</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"V1"</span>


<span class='co'># I repeat this again with different mean and sd</span>

<span class='va'>df_2_10</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>20</span>, mean<span class='op'>=</span><span class='fl'>0.5</span>, sd<span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>df_2_10</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"V1"</span>

<span class='co'># I then combine data frams</span>

<span class='va'>df_2_10_combined</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>df_1_10</span>, <span class='va'>df_2_10</span><span class='op'>)</span>

<span class='co'># I repeat this again with different mean and sd</span>

<span class='va'>df_3_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>20</span>, mean<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>df_3_10</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"V1"</span>

<span class='co'># All data frames are then combined, after which I label the rows as to </span>

<span class='co'># know which class they are in.</span>

<span class='va'>big_df_combined_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>df_2_10_combined</span>, <span class='va'>df_3_10</span><span class='op'>)</span>

<span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> 

<span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"1"</span>

<span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>[</span><span class='fl'>21</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"2"</span>

<span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>[</span><span class='fl'>41</span><span class='op'>:</span><span class='fl'>60</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"3"</span>
</code></pre>
</div>
</div>
<h4 id="b-3">(b)</h4>
<p><strong>Basis:</strong> Perform PCA on the 60 observations and plot
the first two principal component score vectors. Use a different color
to indicate the observations in each of the three classes. If the three
classes appear separated in this plot, then continue on to part (c). If
not, then return to part (a) and modify the simulation so that there is
greater separation between the three classes. Do not continue to part
(c) until the three classes show at least some separation in the first
two principal component score vectors.</p>
<p><strong>Answer:</strong> Next I perform PCA on the 60 randomly
generated observations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># I perform principal components on all by column 51 as this column has the </span>

<span class='co'># Group numbers in it for later reference.</span>

<span class='va'>pca_10_b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>big_df_combined_10</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>51</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>Answer Continued:</strong> Using the base R plot function
below we see that the components have separated noticeably. The black
points on the right have the highest standard deviation of 2 while the
red in the middle have a smaller standard deviation of 0.8 while the
green points on the far right have an standard deviation of 1.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pca_10_b</span><span class='op'>$</span><span class='va'>x</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, pch<span class='op'>=</span><span class='fl'>17</span>,  col <span class='op'>=</span> <span class='op'>(</span><span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>,
xlab <span class='op'>=</span> <span class='st'>"P1"</span>, ylab <span class='op'>=</span> <span class='st'>"P2"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<h4 id="c-2">(c)</h4>
<p><strong>Basis:</strong> Perform K-means clustering of the
observations with K = 3. How well do the clusters that you obtained in
K-means clustering compare to the true class labels?</p>
<p><strong>Answer:</strong> Though it is difficult to interpret in some
ways due to class labels, it appears as if K-means put all of the
correct observations in group 2 and 3 but mis-classified many in group
1, for this see it put 9 in the incorrect groups. This is understandable
as this group was created in my simulated data using the highest
variance so it is concieveable that if its standard deviation was lower
the algorithm would classify it more accurately, however in this case it
was often incorrect.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>928</span><span class='op'>)</span>

<span class='va'>km.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/kmeans.html'>kmeans</a></span><span class='op'>(</span><span class='va'>big_df_combined_10</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>51</span><span class='op'>]</span>, centers<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> 

<span class='va'>km.clusters</span> <span class='op'>&lt;-</span> <span class='va'>km.out</span><span class='op'>$</span><span class='va'>cluster</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>km.clusters</span>, <span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           
km.clusters  1  2  3
          1  8  0  0
          2 11  0  0
          3  1 20 20</code></pre>
</div>
<h4 id="d-2">(d)</h4>
<p><strong>Basis:</strong> Perform K-means clustering with K = 2.
Describe your results.</p>
<p><strong>Answer:</strong> In this case using 2 cluster will force the
clusters to go from 2 to 3 which we see in the km.out$cluster output
being only groups one and two. I this case it assigns all points that
would be in the third cluster to the first cluster which outputs results
of a 3, 20, 20.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>75903</span><span class='op'>)</span>

<span class='va'>km.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/kmeans.html'>kmeans</a></span><span class='op'>(</span><span class='va'>big_df_combined_10</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>51</span><span class='op'>]</span>, centers<span class='op'>=</span><span class='fl'>2</span>,  nstart <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> 

<span class='va'>km.clusters</span> <span class='op'>&lt;-</span> <span class='va'>km.out</span><span class='op'>$</span><span class='va'>cluster</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>km.clusters</span>, <span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           
km.clusters  1  2  3
          1  3 20 20
          2 17  0  0</code></pre>
</div>
<h4 id="e">(e)</h4>
<p><strong>Basis:</strong>Now perform K-means clustering with K = 4, and
describe your results.</p>
<p><strong>Answer:</strong> Similarly to part d above the algorithm
assigns points to a cluster that is not truly in the group assigning
most points to what are truly groups 2 and 3 in the original
km.clusters, however groups 1 and 3 in the new clusters take the
remaining points and split them into 2 clusters where there was only
truly one.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>98367</span><span class='op'>)</span>

<span class='va'>km.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/kmeans.html'>kmeans</a></span><span class='op'>(</span><span class='va'>big_df_combined_10</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>51</span><span class='op'>]</span>, <span class='fl'>4</span><span class='op'>)</span>

<span class='va'>km.clusters</span> <span class='op'>&lt;-</span> <span class='va'>km.out</span><span class='op'>$</span><span class='va'>cluster</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>km.clusters</span>, <span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           
km.clusters  1  2  3
          1  8  0  0
          2  3 20  1
          3  9  0  0
          4  0  0 19</code></pre>
</div>
<h4 id="f">(f)</h4>
<p><strong>Basis:</strong> Now perform K-means clustering with K = 3 on
the first two principal component score vectors, rather than on the raw
data. That is, perform K-means clustering on the 60  2 matrix of which
the first column is the first principal component score vector, and the
second column is the second principal component score vector. Comment on
the results.</p>
<p><strong>Answer:</strong> Using 3 clusters in this case we find that
the k-means assigns all points correctly in groups 2 and 3 in the
original dataset but has difficulty with group 1. This is likely
becasuse the variance in this particular group is quite large having a
standard deviation of 2 compared to 0.8 and 1. The groups also appear to
be incorrectly labeled as in pervious cases as the k-means algorithm
picks groups 1, 2, and 3 arbitrarily while we chose them manually when
making the true groups.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>k.means.pcr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/kmeans.html'>kmeans</a></span><span class='op'>(</span><span class='va'>pca_10_b</span><span class='op'>$</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>3</span><span class='op'>)</span>

<span class='va'>km.clusters</span> <span class='op'>&lt;-</span> <span class='va'>k.means.pcr</span><span class='op'>$</span><span class='va'>cluster</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>98367</span><span class='op'>)</span>

<span class='va'>big_df_no_51</span><span class='op'>&lt;-</span><span class='va'>big_df_combined_10</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>51</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>km.clusters</span>, <span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           
km.clusters  1  2  3
          1  9  0  0
          2  0 20 20
          3 11  0  0</code></pre>
</div>
<h4 id="g-1">(g)</h4>
<p><strong>Basis:</strong> Using the scale() function, perform K-means
clustering with K = 3 on the data after scaling each variable to have
standard deviation one. How do these results compare to those obtained
in (b)? Explain.</p>
<p><strong>Answer:</strong> The results in this case are similar to that
of (b) in this case my first group has a large amount of variance which
has resulted in a large number of observations being placed in the group
nearest to it in terms of its mean. As a result the classifications rate
appears to be similar to earlier problems and most of the
missclasficiations from the first group on the left in b are also being
attributed to the center group, and to a lesser extent, the third
group.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>756</span><span class='op'>)</span>

<span class='va'>km.out_g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/kmeans.html'>kmeans</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>big_df_combined_10</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>51</span><span class='op'>]</span><span class='op'>)</span>, centers<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> 

<span class='va'>km_g.clusters</span> <span class='op'>&lt;-</span> <span class='va'>km.out_g</span><span class='op'>$</span><span class='va'>cluster</span> 

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>km_g.clusters</span>, <span class='va'>big_df_combined_10</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>             
km_g.clusters  1  2  3
            1 10  0  0
            2  9  0  0
            3  1 20 20</code></pre>
</div>
<h2 id="written-questions">Written Questions:</h2>
<h3 id="question-1">Question 1:</h3>
<p><strong>Question:</strong> Based on reading for this class, what are
the main risks of algorithmic models (machine learning) from a fairness
and justice perspective? What forms of modeling/learning and/or sorts of
data may pose particular risks of harm? What general strategies might be
employed to mitigate these risks? Can you think of any methodological
advances that might be pursued by computational and statistical
researchers in order to help data analysts make ethically derived
predictions?</p>
<p><strong>Answer:</strong> Based on the readings for this class there
are a great number of potential fairness and justice risks of the use of
models in many areas of life. The primary ones are the reinforcement of
systems that perpetuate inequality or direct harm to a group through
self-reinforcing predictions and punitive or financial outcomes. As
Oneal writes the collegiate arms race has inflated prices far beyond
inflation while predicted outcomes of policing models ignore white
collar crimes and encourage increased policing which leads to more
punitive outcomes which have far reaching social and financial
consequences.</p>
<p>The algorithms that appear to carry the most risk are predictive
algorithms in the financial and social spaces. Predicting issues such as
recidivism and crime are inevitable going to reinforce the structure in
the world they are meant to predict and since algorithms are stagnant
they cannot evolve to do anything but reflect what they are engineered
to do.</p>
<p>Mitigation of risk is difficult in modeling as algorithms are
inherently reductive and based on the past, as a result there are areas
that they simply should not be used in, perhaps the methodological
advance could be</p>
<p>In earlier chapters, while no acknowledging fault fault, the author
explains the widespread harm caused by predictive algorithms in finance
that assisted in creating the 2008 housing bubble. When the bubble burst
the burden of the fallout was felt by poor and middle class households
who were given sub prime loan and subsequently foreclosed, lost their
savings and credit. As Oneal points out these issues are due to the
opaque nature in being often non-interpretable due to complexity and
inherent mathematical structure. In addition the scale by which certain
algorithms such as recidivism and policing.</p>
<p>(Project update) Data Exploration: Use appropriate methods to explore
the data you plan to use for your project. (Its okay if you change your
mind and use a different data set later; this exercise may help you
decide.) Include some form of visualization(s) and indications of the
unit of analysis, the levels of measurements (e.g.: 9 categorical
features7 dichotomous and 2 with more than two categories and 14
numerical/quantitative features, for a total of 23), univariate
statistics helping characterize the distribution of the features and of
the outcome variable (label) you wish to predict if you will be
conducting supervised learning for the project. Convey something about
relationships among features (predictors). If you are going to use these
for prediction, identify any preprocessing you may need to do and
options available for cleaning up/transforming data and/or dimension
reduction. (Submit with your group or with explanation of why you must
work alone.)</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="putting-network-into-necessary-formats">Putting Network into
Necessary Formats</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="adding-attributes">Adding Attributes</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="brokerage-scores-in-the-1000s">Brokerage scores in the
1000s</h4>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="brokerage-scores-in-the-1100s">Brokerage scores in the
1100s</h4>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="brokerage-scores-in-the-1200s">Brokerage scores in the
1200s</h4>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wars_in_1000s_edgelist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>wars_in_1000s</span><span class='op'>)</span>

<span class='va'>wars_in_1000s_edgelist_network_edgelist</span> <span class='op'>&lt;-</span> 
  <span class='fu'>graph.edgelist</span><span class='op'>(</span><span class='va'>wars_in_1000s_edgelist</span>, directed<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>wars_in_1000s.ig</span><span class='op'>&lt;-</span><span class='fu'>graph_from_data_frame</span><span class='op'>(</span><span class='va'>wars_in_1000s</span><span class='op'>)</span>

<span class='va'>wars_in_1000s_network</span> <span class='op'>&lt;-</span> <span class='fu'>asNetwork</span><span class='op'>(</span><span class='va'>wars_in_1000s.ig</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1000s_states</span> <span class='op'>&lt;-</span>
  <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1000s_states.xlsx"</span><span class='op'>)</span>

<span class='va'>total_1000s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>aspects_of_1000s_states</span>,
                     <span class='va'>wars_in_1000s.nodes.stat_2</span>, by<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1100s_states</span> <span class='op'>&lt;-</span> 
  <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1100s_states.xlsx"</span><span class='op'>)</span>

<span class='va'>total_1100s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>aspects_of_1100s_states</span>, 
                     <span class='va'>wars_in_1100s.nodes.stat_2</span>, by<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1200s_states</span> <span class='op'>&lt;-</span> 
  <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1200s_states.xlsx"</span><span class='op'>)</span>

<span class='va'>total_1200s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>aspects_of_1200s_states</span>, <span class='va'>wars_in_1200s.nodes.stat_2</span>, 
                     by<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1000s_brokerag_reg</span><span class='op'>&lt;-</span><span class='va'>total_1000s</span>

<span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_brokerag_reg_binom</span> <span class='op'>&lt;-</span> 
  <span class='va'>total_1000s_brokerag_reg</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span><span class='op'>~</span><span class='va'>.</span>
      <span class='op'>-</span><span class='va'>name</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>loss_rate</span>, <span class='va'>total_1000s_brokerag_reg_binom</span>, family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span>
</code></pre>
</div>
<pre><code>
Call:  glm(formula = more_win_or_loss ~ . - name - totdegree - indegree - 
    outdegree - dc - eigen.dc - win_rate - loss_rate, family = binomial, 
    data = total_1000s_brokerag_reg_binom)

Coefficients:
 (Intercept)      Catholic         Islam      Orthodox      Buddhist  
  -2.090e+01     1.446e-01    -7.108e-02    -4.043e-01    -8.572e-02  
       Pagan      Tengrism        Shinto         Hindu     Shamanism  
   5.506e-01    -5.656e+01     1.820e+00    -2.142e+00    -1.506e+00  
       eigen         close            rc      eigen.rc    broker.tot  
  -1.877e+03     5.146e+03    -3.979e+00     1.574e+03     2.378e+02  
broker.coord   broker.itin    broker.rep   broker.gate    broker.lia  
  -9.610e+01    -9.449e+01    -7.164e+01    -2.810e+01    -1.298e+02  

Degrees of Freedom: 101 Total (i.e. Null);  82 Residual
  (8 observations deleted due to missingness)
Null Deviance:      140.8 
Residual Deviance: 4.53e-09     AIC: 40</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>292</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s</span><span class='op'>[</span>,<span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span> <span class='op'>&lt;-</span> 
  <span class='va'>total_1000s_for_regression</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span><span class='op'>~</span><span class='va'>.</span>
                  <span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, <span class='va'>total_1000s_for_regression</span>, family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span>
</code></pre>
</div>
<pre><code>
Call:  glm(formula = more_win_or_loss ~ . - loss_rate - win_rate - totdegree - 
    indegree - outdegree - dc - eigen.dc, family = binomial, 
    data = total_1000s_for_regression)

Coefficients:
(Intercept)     Catholic        Islam     Orthodox     Buddhist  
   -15.1948      13.9008      12.7531      14.6893      15.0858  
      Pagan     Tengrism       Shinto        Hindu    Shamanism  
     0.9610      11.6691      16.0623       9.1358      -0.1497  
      eigen        close           rc     eigen.rc  
   -82.1100     256.5294      -3.3322     -17.3152  

Degrees of Freedom: 109 Total (i.e. Null);  96 Residual
Null Deviance:      152.3 
Residual Deviance: 58.4     AIC: 86.4</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>6738</span><span class='op'>)</span>

<span class='va'>in_training</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>)</span>,  
                     <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.7</span> <span class='op'>)</span>

<span class='va'>training_1000s</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>[</span><span class='va'>in_training</span>,<span class='op'>]</span>

<span class='va'>test_1000s</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>[</span><span class='op'>-</span><span class='va'>in_training</span>,<span class='op'>]</span>

<span class='va'>lm_1000s_binom_subset_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span><span class='op'>~</span><span class='va'>.</span>
            <span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, <span class='va'>total_1000s_for_regression</span>, family<span class='op'>=</span><span class='va'>binomial</span>, subset <span class='op'>=</span> <span class='va'>in_training</span> <span class='op'>)</span>

<span class='va'>logsitic_1_1000s_prob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lm_1000s_binom_subset_1</span>, <span class='va'>test_1000s</span>,
type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span>

<span class='va'>log_preds_1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>logsitic_1_1000s_prob</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>

<span class='va'>prediction_1_logs</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>log_preds_1</span> <span class='op'>==</span> <span class='va'>test_1000s</span><span class='op'>$</span><span class='va'>more_win_or_loss</span><span class='op'>)</span>

<span class='va'>prediction_1_logs</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.9090909</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>246</span><span class='op'>)</span>

<span class='va'>x_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span> <span class='op'>~</span> <span class='va'>.</span><span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, 
                        <span class='va'>total_1000s_for_regression</span><span class='op'>)</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> 

<span class='va'>y_ridge</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>more_win_or_loss</span>

<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_ridge</span>, <span class='va'>y_ridge</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ridge.mod</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  14 100</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>729</span><span class='op'>)</span>
<span class='va'>train_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.8</span> <span class='op'>)</span> 

<span class='va'>test_ridge</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>train_ridge</span><span class='op'>)</span>

<span class='va'>y.test_ridge</span> <span class='op'>&lt;-</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span>, thresh <span class='op'>=</span> <span class='fl'>1e-12</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>4</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.2416376</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>231</span><span class='op'>)</span>
<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>0</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>, <span class='op'>]</span>, 
                      exact <span class='op'>=</span> <span class='cn'>T</span>, x <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, 
                      y <span class='op'>=</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>0</span>, exact <span class='op'>=</span> <span class='cn'>T</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, 
        x <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span>, <span class='op'>]</span>
</code></pre>
</div>
<pre><code>(Intercept)    Catholic       Islam    Orthodox    Buddhist 
 0.21024033  0.21827317 -0.01160454  0.21312966  0.35601806 
      Pagan    Tengrism      Shinto       Hindu   Shamanism 
 0.08955257  0.14069809  0.38278477 -0.07034364 -0.01038790 
      eigen       close          rc    eigen.rc 
-4.61480591 12.51011844 -0.29977861  4.64835194 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-58-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>bestlam</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>

<span class='va'>bestlam</span>
</code></pre>
</div>
<pre><code>[1] 0.415338</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv.out</span>, s <span class='op'>=</span> <span class='va'>bestlam</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.174632</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2897</span><span class='op'>)</span>

<span class='va'>x_lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span> <span class='op'>~</span> <span class='va'>.</span><span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, 
                        <span class='va'>total_1000s_for_regression</span><span class='op'>)</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> 

<span class='va'>y_lasso</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>more_win_or_loss</span>

<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span>, <span class='va'>y_lasso</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>lasso.mod</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  14 100</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>729</span><span class='op'>)</span>

<span class='va'>train_lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.8</span> <span class='op'>)</span> 

<span class='va'>test_lasso</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>train_lasso</span><span class='op'>)</span>

<span class='va'>y.test_lasso</span> <span class='op'>&lt;-</span> <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>test_lasso</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span>, <span class='op'>]</span>, <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span><span class='op'>]</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso.mod</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-63-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1029</span><span class='op'>)</span>

<span class='va'>cv.out_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span>, <span class='op'>]</span>, <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-64-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1920</span><span class='op'>)</span>

<span class='va'>bestlam_2</span> <span class='op'>&lt;-</span> <span class='va'>cv.out_2</span><span class='op'>$</span><span class='va'>lambda.min</span>

<span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv.out_2</span>, s <span class='op'>=</span> <span class='va'>bestlam_2</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1749583</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2739</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span>, <span class='op'>]</span>, <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span><span class='op'>]</span>, 
              alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='va'>lasso.coef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>out</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, s <span class='op'>=</span> <span class='va'>bestlam_2</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span>, <span class='op'>]</span>

<span class='va'>lasso.coef</span>
</code></pre>
</div>
<pre><code>(Intercept)    Catholic       Islam    Orthodox    Buddhist 
 0.42561685  0.05577020 -0.09275344  0.00000000  0.00000000 
      Pagan    Tengrism      Shinto       Hindu   Shamanism 
 0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 
      eigen       close          rc    eigen.rc 
 0.00000000  3.22570629 -0.21240622  0.00000000 </code></pre>
</div>
<h3 id="community-grouping">Community Grouping</h3>
<h4 id="label-propagation-1000s">Label Propagation 1000s:</h4>
<p>The first community cluster below is done using label propagation.
This results in 39 groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>23</span><span class='op'>)</span>
<span class='va'>comm.lab</span><span class='op'>&lt;-</span><span class='fu'>label.propagation.community</span><span class='op'>(</span><span class='va'>wars_in_1000s.ig</span><span class='op'>)</span>
<span class='co'>#Inspect clustering object</span>
<span class='co'># igraph::groups(comm.lab)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-68-1.png" width="624" /></p>
</div>
<h4 id="walktrap-1000s">Walktrap 1000s:</h4>
<p>Walktrap classification as seen below results in 19 distinct
communities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>238</span><span class='op'>)</span>
<span class='co'>#Run clustering algorithm: fast_greedy</span>
<span class='va'>wars_in_1000s.wt</span><span class='op'>&lt;-</span><span class='fu'>walktrap.community</span><span class='op'>(</span><span class='va'>wars_in_1000s.ig</span><span class='op'>)</span>

<span class='co'>#igraph::groups(wars_in_1000s.wt)</span>
</code></pre>
</div>
</div>
<p>Adding more steps resulted in 19 groups for both 10 and 20 steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Run &amp; inspect clustering algorithm: 10 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig, steps=10)) </span>
<span class='co'>#Run &amp; inspect clustering algorithm: 20 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig ,steps=20))</span>
<span class='co'>#Run &amp; inspect clustering algorithm</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-71-1.png" width="624" /></p>
</div>
<h3 id="machine-learning-regression-and-principle-components">Machine
Learning, Regression and Principle Components:</h3>
<h4 id="principal-components-1000s">Principal Components 1000s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1000s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_brokerag_reg_binom</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>27</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1000s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        Catholic            Islam         Orthodox         Buddhist 
     0.454545455      0.181818182      0.154545455      0.063636364 
           Pagan         Tengrism           Shinto            Hindu 
     0.036363636      0.018181818      0.054545455      0.045454545 
       Shamanism        totdegree         indegree        outdegree 
     0.009090909      2.754545455      1.336363636      1.418181818 
           eigen            close               rc         eigen.rc 
     0.028058711      0.023546832      0.287358773      0.003637773 
              dc         eigen.dc more_win_or_loss 
     0.712641227      0.024420939      0.481818182 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1000s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        Catholic            Islam         Orthodox         Buddhist 
    0.2502085071     0.1501251043     0.1318598832     0.0601334445 
           Pagan         Tengrism           Shinto            Hindu 
    0.0353628023     0.0180150125     0.0520433695     0.0437864887 
       Shamanism        totdegree         indegree        outdegree 
    0.0090909091     8.9208507089     2.6656380317     6.3189324437 
           eigen            close               rc         eigen.rc 
    0.0076304265     0.0019575460     0.1260782284     0.0004728954 
              dc         eigen.dc more_win_or_loss 
    0.1260782284     0.0056490031     0.2519599666 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>total_1000s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>center</span>
</code></pre>
</div>
<pre><code>        Catholic            Islam         Orthodox         Buddhist 
     0.454545455      0.181818182      0.154545455      0.063636364 
           Pagan         Tengrism           Shinto            Hindu 
     0.036363636      0.018181818      0.054545455      0.045454545 
       Shamanism        totdegree         indegree        outdegree 
     0.009090909      2.754545455      1.336363636      1.418181818 
           eigen            close               rc         eigen.rc 
     0.028058711      0.023546832      0.287358773      0.003637773 
              dc         eigen.dc more_win_or_loss 
     0.712641227      0.024420939      0.481818182 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>scale</span>
</code></pre>
</div>
<pre><code>        Catholic            Islam         Orthodox         Buddhist 
      0.50020846       0.38745981       0.36312516       0.24522122 
           Pagan         Tengrism           Shinto            Hindu 
      0.18805000       0.13422002       0.22813016       0.20925221 
       Shamanism        totdegree         indegree        outdegree 
      0.09534626       2.98677932       1.63267818       2.51374868 
           eigen            close               rc         eigen.rc 
      0.08735231       0.04424416       0.35507496       0.02174616 
              dc         eigen.dc more_win_or_loss 
      0.35507496       0.07515985       0.50195614 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-79-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>172</span><span class='op'>)</span>

<span class='fu'>ggbiplot</span><span class='op'>(</span><span class='va'>pr.out</span>, labels <span class='op'>=</span>  <span class='va'>total_1000s_for_PCA</span><span class='op'>$</span><span class='va'>name</span>, labels.size  <span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Principal Components 1000s"</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-80-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>rotation</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>rotation</span> 

<span class='va'>pr.out</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-81-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span>
</code></pre>
</div>
<pre><code> [1] 2.217501e+00 1.681548e+00 1.239242e+00 1.211199e+00 1.065982e+00
 [6] 1.037692e+00 1.029507e+00 1.011117e+00 1.005425e+00 9.514802e-01
[11] 8.848499e-01 7.782431e-01 6.162540e-01 4.426224e-01 2.541422e-01
[16] 1.091189e-01 7.597269e-16 6.258811e-16 2.174635e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var</span> <span class='op'>&lt;-</span> <span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var</span>
</code></pre>
</div>
<pre><code> [1] 4.917311e+00 2.827605e+00 1.535720e+00 1.467004e+00 1.136318e+00
 [6] 1.076804e+00 1.059884e+00 1.022359e+00 1.010879e+00 9.053146e-01
[11] 7.829594e-01 6.056623e-01 3.797690e-01 1.959146e-01 6.458828e-02
[16] 1.190694e-02 5.771849e-31 3.917271e-31 4.729037e-32</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve</span> <span class='op'>&lt;-</span> <span class='va'>pr.var</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var</span><span class='op'>)</span>

<span class='va'>pve</span>
</code></pre>
</div>
<pre><code> [1] 2.588059e-01 1.488213e-01 8.082739e-02 7.721075e-02 5.980622e-02
 [6] 5.667390e-02 5.578337e-02 5.380835e-02 5.320417e-02 4.764814e-02
[11] 4.120839e-02 3.187696e-02 1.998784e-02 1.031129e-02 3.399383e-03
[16] 6.266808e-04 3.037815e-32 2.061722e-32 2.488967e-33</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pve</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>pve</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Cumulative Proportion of Variance Explained"</span>, 
ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-85-1.png" width="624" /></p>
</div>
<h4 id="label-propagation-1100s">Label Propagation 1100s:</h4>
<p>The first community cluster below is done using label propagation.
This results in 39 groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>23</span><span class='op'>)</span>
<span class='va'>comm.lab</span><span class='op'>&lt;-</span><span class='fu'>label.propagation.community</span><span class='op'>(</span><span class='va'>wars_in_1100s.ig</span><span class='op'>)</span>
<span class='co'>#Inspect clustering object</span>
<span class='co'># igraph::groups(comm.lab)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-87-1.png" width="624" /></p>
</div>
<h4 id="walktrap-1000s-1">Walktrap 1000s:</h4>
<p>Walktrap classification as seen below results in 19 distinct
communities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>238</span><span class='op'>)</span>
<span class='co'>#Run clustering algorithm: fast_greedy</span>
<span class='va'>wars_in_1100s.wt</span><span class='op'>&lt;-</span><span class='fu'>walktrap.community</span><span class='op'>(</span><span class='va'>wars_in_1100s.ig</span><span class='op'>)</span>

<span class='co'>#igraph::groups(wars_in_1000s.wt)</span>
</code></pre>
</div>
</div>
<p>Adding more steps resulted in 19 groups for both 10 and 20 steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Run &amp; inspect clustering algorithm: 10 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig, steps=10)) </span>
<span class='co'>#Run &amp; inspect clustering algorithm: 20 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig ,steps=20))</span>
<span class='co'>#Run &amp; inspect clustering algorithm</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-90-1.png" width="624" /></p>
</div>
<h4 id="principal-components-1200s">Principal Components 1200s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>total_1200s</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;name&quot;         &quot;Catholic&quot;     &quot;Islam&quot;        &quot;Orthodox&quot;    
 [5] &quot;Buddhist&quot;     &quot;Pagan&quot;        &quot;Tengrism&quot;     &quot;Shinto&quot;      
 [9] &quot;Hindu&quot;        &quot;Shamanism&quot;    &quot;totdegree&quot;    &quot;indegree&quot;    
[13] &quot;outdegree&quot;    &quot;eigen&quot;        &quot;rc&quot;           &quot;eigen.rc&quot;    
[17] &quot;dc&quot;           &quot;eigen.dc&quot;     &quot;broker.tot&quot;   &quot;broker.coord&quot;
[21] &quot;broker.itin&quot;  &quot;broker.rep&quot;   &quot;broker.gate&quot;  &quot;broker.lia&quot;  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg</span><span class='op'>&lt;-</span><span class='va'>total_1200s</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg_binom</span> <span class='op'>&lt;-</span>
  <span class='va'>total_1200s_brokerag_reg</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1200s_brokerag_reg_binom</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>27</span><span class='op'>)</span><span class='op'>]</span>


<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   Catholic       Islam    Orthodox    Buddhist       Pagan 
0.712500000 0.068750000 0.087500000 0.087500000 0.012500000 
   Tengrism      Shinto       Hindu   Shamanism   totdegree 
0.025000000 0.000000000 0.006250000 0.000000000 3.918750000 
   indegree   outdegree       eigen          rc    eigen.rc 
1.962500000 1.956250000 0.025567955 0.158754617 0.002192746 
         dc    eigen.dc  broker.tot 
0.841245383 0.023375209 0.341581810 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    Catholic        Islam     Orthodox     Buddhist        Pagan 
2.061321e-01 6.442610e-02 8.034591e-02 8.034591e-02 1.242138e-02 
    Tengrism       Shinto        Hindu    Shamanism    totdegree 
2.452830e-02 0.000000e+00 6.250000e-03 0.000000e+00 2.666631e+01 
    indegree    outdegree        eigen           rc     eigen.rc 
6.237579e+00 1.595405e+01 5.631476e-03 7.141295e-02 7.316162e-05 
          dc     eigen.dc   broker.tot 
7.141295e-02 4.574350e-03 3.001236e+01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># I cannot scale variables with </span>

<span class='va'>total_1200s_for_PCA</span><span class='op'>&lt;-</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>center</span>
</code></pre>
</div>
<pre><code>   Catholic       Islam    Orthodox    Buddhist       Pagan 
0.712500000 0.068750000 0.087500000 0.087500000 0.012500000 
   Tengrism       Hindu   totdegree    indegree   outdegree 
0.025000000 0.006250000 3.918750000 1.962500000 1.956250000 
      eigen          rc    eigen.rc          dc    eigen.dc 
0.025567955 0.158754617 0.002192746 0.841245383 0.023375209 
 broker.tot 
0.341581810 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>scale</span>
</code></pre>
</div>
<pre><code>   Catholic       Islam    Orthodox    Buddhist       Pagan 
0.454017704 0.253822971 0.283453545 0.283453545 0.111451261 
   Tengrism       Hindu   totdegree    indegree   outdegree 
0.156615139 0.079056942 5.163943541 2.497514488 3.994251963 
      eigen          rc    eigen.rc          dc    eigen.dc 
0.075043164 0.267232010 0.008553457 0.267232010 0.067633938 
 broker.tot 
5.478353760 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-104-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> 

<span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-105-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>8192</span><span class='op'>)</span>

<span class='fu'>ggbiplot</span><span class='op'>(</span><span class='va'>pr.out_2</span>, labels <span class='op'>=</span>  <span class='va'>total_1200s_for_PCA</span><span class='op'>$</span><span class='va'>name</span>, 
         labels.size  <span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Principal Components 1200s"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-106-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span>
</code></pre>
</div>
<pre><code> [1] 2.217501e+00 1.681548e+00 1.239242e+00 1.211199e+00 1.065982e+00
 [6] 1.037692e+00 1.029507e+00 1.011117e+00 1.005425e+00 9.514802e-01
[11] 8.848499e-01 7.782431e-01 6.162540e-01 4.426224e-01 2.541422e-01
[16] 1.091189e-01 7.597269e-16 6.258811e-16 2.174635e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var_2</span>
</code></pre>
</div>
<pre><code> [1] 4.903737e+00 2.344663e+00 1.670548e+00 1.250176e+00 1.132904e+00
 [6] 1.097802e+00 1.011326e+00 9.460639e-01 8.661454e-01 5.139677e-01
[11] 1.659928e-01 9.667541e-02 2.916516e-30 4.832251e-31 2.292490e-31
[16] 1.889562e-32</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.var_2</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var_2</span><span class='op'>)</span>

<span class='va'>pve_2</span>
</code></pre>
</div>
<pre><code> [1] 3.064835e-01 1.465414e-01 1.044092e-01 7.813602e-02 7.080651e-02
 [6] 6.861260e-02 6.320785e-02 5.912899e-02 5.413409e-02 3.212298e-02
[11] 1.037455e-02 6.042213e-03 1.822822e-31 3.020157e-32 1.432806e-32
[16] 1.180977e-33</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pve_2</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>pve_2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Cumulative Proportion of Variance Explained"</span>, 
ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-110-1.png" width="624" /></p>
</div>
<h4 id="label-propagation-1200s">Label Propagation 1200s:</h4>
<p>The first community cluster below is done using label propagation.
This results in 39 groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>23</span><span class='op'>)</span>
<span class='va'>comm.lab</span><span class='op'>&lt;-</span><span class='fu'>label.propagation.community</span><span class='op'>(</span><span class='va'>wars_in_1200s.ig</span><span class='op'>)</span>
<span class='co'>#Inspect clustering object</span>
<span class='co'># igraph::groups(comm.lab)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-112-1.png" width="624" /></p>
</div>
<h4 id="walktrap-1200s">Walktrap 1200s:</h4>
<p>Walktrap classification as seen below results in 19 distinct
communities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>238</span><span class='op'>)</span>
<span class='co'>#Run clustering algorithm: fast_greedy</span>
<span class='va'>wars_in_1200s.wt</span><span class='op'>&lt;-</span><span class='fu'>walktrap.community</span><span class='op'>(</span><span class='va'>wars_in_1200s.ig</span><span class='op'>)</span>

<span class='co'>#igraph::groups(wars_in_1000s.wt)</span>
</code></pre>
</div>
</div>
<p>Adding more steps resulted in 19 groups for both 10 and 20 steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Run &amp; inspect clustering algorithm: 10 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig, steps=10)) </span>
<span class='co'>#Run &amp; inspect clustering algorithm: 20 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig ,steps=20))</span>
<span class='co'>#Run &amp; inspect clustering algorithm</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-115-1.png" width="624" /></p>
</div>
<h4 id="principal-components-1100s">Principal Components 1100s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>total_1100s</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;name&quot;         &quot;Catholic&quot;     &quot;Islam&quot;        &quot;Orthodox&quot;    
 [5] &quot;Buddhist&quot;     &quot;Pagan&quot;        &quot;Tengrism&quot;     &quot;Shinto&quot;      
 [9] &quot;Hindu&quot;        &quot;Shamanism&quot;    &quot;totdegree&quot;    &quot;indegree&quot;    
[13] &quot;outdegree&quot;    &quot;eigen&quot;        &quot;rc&quot;           &quot;eigen.rc&quot;    
[17] &quot;dc&quot;           &quot;eigen.dc&quot;     &quot;broker.tot&quot;   &quot;broker.coord&quot;
[21] &quot;broker.itin&quot;  &quot;broker.rep&quot;   &quot;broker.gate&quot;  &quot;broker.lia&quot;  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>&lt;-</span><span class='va'>total_1100s</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg_binom</span> <span class='op'>&lt;-</span> 
  <span class='va'>total_1100s_brokerag_reg</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1100s_brokerag_reg_binom</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>27</span><span class='op'>)</span><span class='op'>]</span>


<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    Catholic        Islam     Orthodox     Buddhist        Pagan 
 0.578947368  0.157894737  0.042105263  0.042105263  0.105263158 
    Tengrism       Shinto        Hindu    Shamanism    totdegree 
 0.000000000  0.042105263  0.031578947  0.000000000  4.884210526 
    indegree    outdegree        eigen           rc     eigen.rc 
 2.505263158  2.378947368  0.036211017  0.177160501  0.005625786 
          dc     eigen.dc   broker.tot 
 0.822839499  0.030585231 -0.243595160 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    Catholic        Islam     Orthodox     Buddhist        Pagan 
2.463606e-01 1.343785e-01 4.076148e-02 4.076148e-02 9.518477e-02 
    Tengrism       Shinto        Hindu    Shamanism    totdegree 
0.000000e+00 4.076148e-02 3.090705e-02 0.000000e+00 2.689071e+01 
    indegree    outdegree        eigen           rc     eigen.rc 
9.529227e+00 1.819530e+01 9.313111e-03 5.984348e-02 6.128935e-04 
          dc     eigen.dc   broker.tot 
5.984348e-02 5.883890e-03 7.605503e+00 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># I cannot scale variables with </span>

<span class='va'>total_1100s_for_PCA</span><span class='op'>&lt;-</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>7</span><span class='op'>)</span><span class='op'>]</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>center</span>
</code></pre>
</div>
<pre><code>    Catholic        Islam     Orthodox     Buddhist        Pagan 
 0.578947368  0.157894737  0.042105263  0.042105263  0.105263158 
       Hindu    totdegree     indegree    outdegree        eigen 
 0.031578947  4.884210526  2.505263158  2.378947368  0.036211017 
          rc     eigen.rc           dc     eigen.dc   broker.tot 
 0.177160501  0.005625786  0.822839499  0.030585231 -0.243595160 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>scale</span>
</code></pre>
</div>
<pre><code>  Catholic      Islam   Orthodox   Buddhist      Pagan      Hindu 
0.49634724 0.36657673 0.20189472 0.20189472 0.30852029 0.17580402 
 totdegree   indegree  outdegree      eigen         rc   eigen.rc 
5.18562489 3.08694466 4.26559454 0.09650446 0.24462928 0.02475669 
        dc   eigen.dc broker.tot 
0.24462928 0.07670652 2.75780766 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-129-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> 

<span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-130-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>8192</span><span class='op'>)</span>

<span class='fu'>ggbiplot</span><span class='op'>(</span><span class='va'>pr.out_2</span>, labels <span class='op'>=</span>  
           <span class='va'>total_1100s_for_PCA</span><span class='op'>$</span><span class='va'>name</span>, labels.size  <span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Principal Components 1100s"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-131-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span>
</code></pre>
</div>
<pre><code> [1] 2.217501e+00 1.681548e+00 1.239242e+00 1.211199e+00 1.065982e+00
 [6] 1.037692e+00 1.029507e+00 1.011117e+00 1.005425e+00 9.514802e-01
[11] 8.848499e-01 7.782431e-01 6.162540e-01 4.426224e-01 2.541422e-01
[16] 1.091189e-01 7.597269e-16 6.258811e-16 2.174635e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var_2</span>
</code></pre>
</div>
<pre><code> [1] 5.025184e+00 2.232839e+00 1.714571e+00 1.514786e+00 1.087278e+00
 [6] 1.040944e+00 9.808822e-01 5.914503e-01 4.402797e-01 2.212555e-01
[11] 9.042887e-02 6.010089e-02 9.541994e-31 3.696101e-31 3.059734e-32</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.var_2</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var_2</span><span class='op'>)</span>

<span class='va'>pve_2</span>
</code></pre>
</div>
<pre><code> [1] 3.350123e-01 1.488559e-01 1.143048e-01 1.009857e-01 7.248522e-02
 [6] 6.939624e-02 6.539214e-02 3.943002e-02 2.935198e-02 1.475036e-02
[11] 6.028591e-03 4.006726e-03 6.361330e-32 2.464068e-32 2.039823e-33</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pve_2</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>pve_2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Cumulative Proportion of Variance Explained"</span>, 
ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="ml-homework-3_files/figure-html5/unnamed-chunk-135-1.png" width="624" /></p>
</div>
<div class="sourceCode" id="cb51"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
