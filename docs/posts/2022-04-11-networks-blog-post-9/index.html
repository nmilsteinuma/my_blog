<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Noah Milstein DACSS Blog: Networks Blog Post 9</title>

<meta property="description" itemprop="description" content="A short description of the post."/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-04-11"/>
<meta property="article:created" itemprop="dateCreated" content="2022-04-11"/>
<meta name="article:author" content="Noah Milstein"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Noah Milstein DACSS Blog: Networks Blog Post 9"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A short description of the post."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Noah Milstein DACSS Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Noah Milstein DACSS Blog: Networks Blog Post 9"/>
<meta property="twitter:description" content="A short description of the post."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Networks Blog Post 9"]},{"type":"character","attributes":{},"value":["A short description of the post."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Noah Milstein"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2022-04-11"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["networks-blog-post-9_files/anchor-4.2.2/anchor.min.js","networks-blog-post-9_files/bowser-1.9.3/bowser.min.js","networks-blog-post-9_files/distill-2.2.21/template.v2.js","networks-blog-post-9_files/figure-html5/unnamed-chunk-10-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-100-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-102-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-103-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-104-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-105-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-107-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-108-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-109-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-11-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-110-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-111-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-112-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-113-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-114-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-115-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-116-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-117-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-118-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-119-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-12-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-121-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-122-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-123-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-124-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-125-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-126-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-127-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-128-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-129-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-13-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-130-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-131-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-132-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-133-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-134-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-135-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-136-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-137-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-138-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-140-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-141-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-143-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-144-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-145-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-146-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-147-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-149-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-150-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-152-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-153-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-155-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-158-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-161-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-162-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-167-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-168-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-169-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-174-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-175-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-176-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-179-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-180-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-181-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-183-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-183-2.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-183-3.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-184-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-184-2.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-184-3.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-185-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-185-2.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-185-3.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-186-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-188-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-188-2.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-188-3.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-189-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-189-2.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-189-3.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-190-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-190-2.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-190-3.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-193-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-25-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-26-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-30-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-31-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-32-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-35-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-36-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-38-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-39-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-46-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-47-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-48-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-49-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-52-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-53-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-54-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-55-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-57-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-58-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-66-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-67-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-68-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-71-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-72-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-73-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-74-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-77-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-78-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-79-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-80-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-81-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-82-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-83-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-84-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-85-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-86-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-88-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-89-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-92-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-94-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-96-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-97-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-98-1.png","networks-blog-post-9_files/figure-html5/unnamed-chunk-99-1.png","networks-blog-post-9_files/header-attrs-2.13/header-attrs.js","networks-blog-post-9_files/jquery-3.6.0/jquery-3.6.0.js","networks-blog-post-9_files/jquery-3.6.0/jquery-3.6.0.min.js","networks-blog-post-9_files/jquery-3.6.0/jquery-3.6.0.min.map","networks-blog-post-9_files/popper-2.6.0/popper.min.js","networks-blog-post-9_files/tippy-6.2.7/tippy-bundle.umd.min.js","networks-blog-post-9_files/tippy-6.2.7/tippy-light-border.css","networks-blog-post-9_files/tippy-6.2.7/tippy.css","networks-blog-post-9_files/tippy-6.2.7/tippy.umd.min.js","networks-blog-post-9_files/webcomponents-2.0.0/webcomponents.js","rplot.pdf"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.13/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Networks Blog Post 9","description":"A short description of the post.","authors":[{"author":"Noah Milstein","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-04-11T00:00:00.000-04:00","citationText":"Milstein, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Noah Milstein DACSS Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Networks Blog Post 9</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A short description of the post.</p></p>
</div>

<div class="d-byline">
  Noah Milstein true 
  
<br/>2022-04-11
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="loading-the-networks">Loading the Networks</h1>
<h2 id="putting-network-into-necessary-formats">Putting Network into
Necessary Formats</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="adding-attributes">Adding Attributes</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="brokerage-scores-in-the-1000s">Brokerage scores in the
1000s</h4>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="brokerage-scores-in-the-1100s">Brokerage scores in the
1100s</h4>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="brokerage-scores-in-the-1200s">Brokerage scores in the
1200s</h4>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="inital-graphical-representation">Inital Graphical
Representation</h1>
<h3 id="s-ggplot">1000s GGplot</h3>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#summary(wars_in_1100s_network)</span>
</code></pre>
</div>
</div>
<h3 id="s-ggplot-1">1100s GGplot</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<h3 id="s-ggplot-2">1200s GGplot</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wars_in_1000s_edgelist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>wars_in_1000s</span><span class='op'>)</span>

<span class='va'>wars_in_1000s_edgelist_network_edgelist</span> <span class='op'>&lt;-</span> <span class='fu'>graph.edgelist</span><span class='op'>(</span><span class='va'>wars_in_1000s_edgelist</span>, directed<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>wars_in_1000s.ig</span><span class='op'>&lt;-</span><span class='fu'>graph_from_data_frame</span><span class='op'>(</span><span class='va'>wars_in_1000s</span><span class='op'>)</span>

<span class='va'>wars_in_1000s_network</span> <span class='op'>&lt;-</span> <span class='fu'>asNetwork</span><span class='op'>(</span><span class='va'>wars_in_1000s.ig</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1000s_states</span> <span class='op'>&lt;-</span> <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1000s_states.xlsx"</span><span class='op'>)</span>

<span class='va'>total_1000s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>aspects_of_1000s_states</span>, <span class='va'>wars_in_1000s.nodes.stat_2</span>, by<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1100s_states</span> <span class='op'>&lt;-</span> <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1100s_states.xlsx"</span><span class='op'>)</span>

<span class='va'>total_1100s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>aspects_of_1100s_states</span>, <span class='va'>wars_in_1100s.nodes.stat_2</span>, by<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1200s_states</span> <span class='op'>&lt;-</span> <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1200s_states.xlsx"</span><span class='op'>)</span>

<span class='va'>total_1200s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>aspects_of_1200s_states</span>, <span class='va'>wars_in_1200s.nodes.stat_2</span>, by<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1000s_brokerag_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>total_1000s</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>total_1000s_brokerag_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>)</span>


<span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>name</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s</span><span class='op'>$</span><span class='va'>name</span>
<span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1000s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_brokerag_reg_binom</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_brokerag_reg</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span><span class='op'>~</span><span class='va'>.</span><span class='op'>-</span><span class='va'>name</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>loss_rate</span>, <span class='va'>total_1000s_brokerag_reg_binom</span>, family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span>
</code></pre>
</div>
<pre><code>
Call:  glm(formula = more_win_or_loss ~ . - name - totdegree - indegree - 
    outdegree - dc - eigen.dc - win_rate - loss_rate, family = binomial, 
    data = total_1000s_brokerag_reg_binom)

Coefficients:
 (Intercept)      Catholic         Islam      Orthodox      Buddhist  
      6.1272        1.4356        1.0035        1.9618        0.8589  
       Pagan      Tengrism        Shinto         Hindu     Shamanism  
      3.5228        2.8722        0.3449        4.4574        1.9021  
       eigen         close            rc      eigen.rc    broker.tot  
     -2.1536        1.5665        1.3695       12.5519       30.9756  
broker.coord   broker.itin    broker.rep   broker.gate    broker.lia  
     -0.4219       -1.6517       -1.2439       -1.8494      -21.6928  

Degrees of Freedom: 101 Total (i.e. Null);  82 Residual
  (8 observations deleted due to missingness)
Null Deviance:      137.5 
Residual Deviance: 85.48    AIC: 125.5</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>292</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>total_1000s</span><span class='op'>[</span>,<span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>20</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>total_1000s_for_regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>

<span class='va'>total_1000s_for_regression</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span><span class='op'>~</span><span class='va'>.</span><span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, <span class='va'>total_1000s_for_regression</span>, family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span>

<span class='va'>First_1000s_regression</span>
</code></pre>
</div>
<pre><code>
Call:  glm(formula = more_win_or_loss ~ . - loss_rate - win_rate - totdegree - 
    indegree - outdegree - dc - eigen.dc, family = binomial, 
    data = total_1000s_for_regression)

Coefficients:
(Intercept)     Catholic        Islam     Orthodox     Buddhist  
     2.6597       1.2541       0.7489       1.8791       0.7895  
      Pagan     Tengrism       Shinto        Hindu    Shamanism  
     3.5081       2.8316       0.2949       4.3849       1.8906  
      eigen        close           rc     eigen.rc  
    -1.7084       1.3624       1.2501       1.9155  

Degrees of Freedom: 109 Total (i.e. Null);  96 Residual
Null Deviance:      147.2 
Residual Deviance: 99.03    AIC: 127</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>6738</span><span class='op'>)</span>

<span class='va'>in_training</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>)</span>,  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>total_1000s_for_regression</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.7</span> <span class='op'>)</span>

<span class='va'>training_1000s</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>[</span><span class='va'>in_training</span>,<span class='op'>]</span>

<span class='va'>test_1000s</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>[</span><span class='op'>-</span><span class='va'>in_training</span>,<span class='op'>]</span>

<span class='va'>lm_1000s_binom_subset_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span><span class='op'>~</span><span class='va'>.</span><span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, <span class='va'>total_1000s_for_regression</span>, family<span class='op'>=</span><span class='va'>binomial</span>, subset <span class='op'>=</span> <span class='va'>in_training</span> <span class='op'>)</span>

<span class='va'>logsitic_1_1000s_prob</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lm_1000s_binom_subset_1</span>, <span class='va'>test_1000s</span>,
type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span>

<span class='va'>log_preds_1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>logsitic_1_1000s_prob</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>

<span class='va'>prediction_1_logs</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>log_preds_1</span> <span class='op'>==</span> <span class='va'>test_1000s</span><span class='op'>$</span><span class='va'>more_win_or_loss</span><span class='op'>)</span>

<span class='va'>prediction_1_logs</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.7272727</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>246</span><span class='op'>)</span>

<span class='va'>x_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span> <span class='op'>~</span> <span class='va'>.</span><span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, <span class='va'>total_1000s_for_regression</span><span class='op'>)</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> 

<span class='va'>y_ridge</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>more_win_or_loss</span>

<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_ridge</span>, <span class='va'>y_ridge</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ridge.mod</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  14 100</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>729</span><span class='op'>)</span>
<span class='va'>train_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.8</span> <span class='op'>)</span> 

<span class='va'>test_ridge</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>train_ridge</span><span class='op'>)</span>

<span class='va'>y.test_ridge</span> <span class='op'>&lt;-</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span>, thresh <span class='op'>=</span> <span class='fl'>1e-12</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>4</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.238849</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>231</span><span class='op'>)</span>
<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>0</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>, <span class='op'>]</span>, 
                      exact <span class='op'>=</span> <span class='cn'>T</span>, x <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='fl'>0</span>, exact <span class='op'>=</span> <span class='cn'>T</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, 
        x <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span>, <span class='op'>]</span>
</code></pre>
</div>
<pre><code>(Intercept)    Catholic       Islam    Orthodox    Buddhist 
 0.62262544  0.17425166  0.10710186  0.26674490  0.14127907 
      Pagan    Tengrism      Shinto       Hindu   Shamanism 
 0.09958513  0.11676503  0.05824048  0.16555932  0.06608253 
      eigen       close          rc    eigen.rc 
-0.19106753  0.19026955  0.17419215  0.07078561 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span>, <span class='op'>]</span>, <span class='va'>y_ridge</span><span class='op'>[</span><span class='va'>train_ridge</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>bestlam</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>

<span class='va'>bestlam</span>
</code></pre>
</div>
<pre><code>[1] 0.1930504</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv.out</span>, s <span class='op'>=</span> <span class='va'>bestlam</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1733588</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2897</span><span class='op'>)</span>

<span class='va'>x_lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>more_win_or_loss</span> <span class='op'>~</span> <span class='va'>.</span><span class='op'>-</span><span class='va'>loss_rate</span><span class='op'>-</span><span class='va'>win_rate</span><span class='op'>-</span><span class='va'>totdegree</span><span class='op'>-</span><span class='va'>indegree</span><span class='op'>-</span><span class='va'>outdegree</span><span class='op'>-</span><span class='va'>dc</span><span class='op'>-</span><span class='va'>eigen.dc</span>, <span class='va'>total_1000s_for_regression</span><span class='op'>)</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> 

<span class='va'>y_lasso</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_for_regression</span><span class='op'>$</span><span class='va'>more_win_or_loss</span>

<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span>, <span class='va'>y_lasso</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>lasso.mod</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  14 100</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>729</span><span class='op'>)</span>

<span class='va'>train_lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>x_ridge</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.8</span> <span class='op'>)</span> 

<span class='va'>test_lasso</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>-</span><span class='va'>train_lasso</span><span class='op'>)</span>

<span class='va'>y.test_lasso</span> <span class='op'>&lt;-</span> <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>test_lasso</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>9292</span><span class='op'>)</span>

<span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span>, <span class='op'>]</span>, <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span><span class='op'>]</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso.mod</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1029</span><span class='op'>)</span>

<span class='va'>cv.out_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span>, <span class='op'>]</span>, <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-32-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1920</span><span class='op'>)</span>

<span class='va'>bestlam_2</span> <span class='op'>&lt;-</span> <span class='va'>cv.out_2</span><span class='op'>$</span><span class='va'>lambda.min</span>

<span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv.out_2</span>, s <span class='op'>=</span> <span class='va'>bestlam_2</span>, newx <span class='op'>=</span> <span class='va'>x_ridge</span><span class='op'>[</span><span class='va'>test_ridge</span>,<span class='op'>]</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y.test_ridge</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>kable</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1946013</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2739</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span>, <span class='op'>]</span>, <span class='va'>y_lasso</span><span class='op'>[</span><span class='va'>train_lasso</span><span class='op'>]</span>, 
              alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>

<span class='va'>lasso.coef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>out</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, s <span class='op'>=</span> <span class='va'>bestlam_2</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>14</span>, <span class='op'>]</span>

<span class='va'>lasso.coef</span>
</code></pre>
</div>
<pre><code>(Intercept)    Catholic       Islam    Orthodox    Buddhist 
 0.61939985 -0.01942777 -0.04501563  0.05244203  0.00000000 
      Pagan    Tengrism      Shinto       Hindu   Shamanism 
 0.01462560  0.01837641  0.00000000  0.01737283  0.00000000 
      eigen       close          rc    eigen.rc 
 0.00000000  0.00000000  0.12599252  0.00000000 </code></pre>
</div>
<h3 id="community-grouping">Community Grouping</h3>
<h4 id="label-propagation-1000s">Label Propagation 1000s:</h4>
<p>The first community cluster below is done using label propagation.
This results in 39 groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>23</span><span class='op'>)</span>
<span class='va'>comm.lab</span><span class='op'>&lt;-</span><span class='fu'>label.propagation.community</span><span class='op'>(</span><span class='va'>wars_in_1000s.ig</span><span class='op'>)</span>
<span class='co'>#Inspect clustering object</span>
<span class='co'># igraph::groups(comm.lab)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<h4 id="walktrap-1000s">Walktrap 1000s:</h4>
<p>Walktrap classification as seen below results in 19 distinct
communities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>238</span><span class='op'>)</span>
<span class='co'>#Run clustering algorithm: fast_greedy</span>
<span class='va'>wars_in_1000s.wt</span><span class='op'>&lt;-</span><span class='fu'>walktrap.community</span><span class='op'>(</span><span class='va'>wars_in_1000s.ig</span><span class='op'>)</span>

<span class='co'>#igraph::groups(wars_in_1000s.wt)</span>
</code></pre>
</div>
</div>
<p>Adding more steps resulted in 19 groups for both 10 and 20 steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Run &amp; inspect clustering algorithm: 10 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig, steps=10)) </span>
<span class='co'>#Run &amp; inspect clustering algorithm: 20 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig ,steps=20))</span>
<span class='co'>#Run &amp; inspect clustering algorithm</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-39-1.png" width="624" /></p>
</div>
<h3 id="machine-learning-regression-and-principle-components">Machine
Learning, Regression and Principle Components:</h3>
<h4 id="principal-components-1000s">Principal Components 1000s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1000s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1000s_brokerag_reg_binom</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>:</span><span class='fl'>27</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1000s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
   -4.543990e-17     2.070087e-17     5.551115e-17     8.026053e-18 
        Tengrism           Shinto            Hindu        Shamanism 
    4.023376e-18     0.000000e+00    -1.764317e-17     6.598356e-18 
       totdegree         indegree        outdegree            eigen 
    5.849172e-17    -6.382747e-18    -9.967761e-18    -3.483123e-17 
           close               rc         eigen.rc               dc 
   -1.804408e-17     4.784670e-17     1.054879e-18     1.351414e-16 
        eigen.dc       broker.tot more_win_or_loss 
   -1.968172e-17     1.007791e-17     6.090909e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1000s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
       1.0000000        1.0000000        1.0000000        1.0000000 
        Tengrism           Shinto            Hindu        Shamanism 
       1.0000000        1.0000000        1.0000000        1.0000000 
       totdegree         indegree        outdegree            eigen 
       1.0000000        1.0000000        1.0000000        1.0000000 
           close               rc         eigen.rc               dc 
       1.0000000        1.0000000        1.0000000        1.0000000 
        eigen.dc       broker.tot more_win_or_loss 
       1.0000000        1.0000000        0.2402836 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>total_1000s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>center</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
   -4.541821e-17     2.069052e-17     5.551115e-17     8.074349e-18 
        Tengrism           Shinto            Hindu        Shamanism 
    4.037175e-18     0.000000e+00    -1.766264e-17     6.560409e-18 
       totdegree         indegree        outdegree            eigen 
    5.853903e-17    -6.308085e-18    -9.840613e-18    -3.482063e-17 
           close               rc         eigen.rc               dc 
   -1.810421e-17     4.782317e-17     1.009294e-18     1.351428e-16 
        eigen.dc       broker.tot more_win_or_loss 
   -1.968123e-17     1.009294e-17     6.090909e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>scale</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
       1.0000000        1.0000000        1.0000000        1.0000000 
        Tengrism           Shinto            Hindu        Shamanism 
       1.0000000        1.0000000        1.0000000        1.0000000 
       totdegree         indegree        outdegree            eigen 
       1.0000000        1.0000000        1.0000000        1.0000000 
           close               rc         eigen.rc               dc 
       1.0000000        1.0000000        1.0000000        1.0000000 
        eigen.dc       broker.tot more_win_or_loss 
       1.0000000        1.0000000        0.4901873 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-47-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>172</span><span class='op'>)</span>

<span class='fu'>ggbiplot</span><span class='op'>(</span><span class='va'>pr.out</span>, labels <span class='op'>=</span>  <span class='va'>total_1000s</span><span class='op'>$</span><span class='va'>name</span>, labels.size  <span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Principal Components 1000s"</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-48-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>rotation</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>rotation</span> 

<span class='va'>pr.out</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-49-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span>
</code></pre>
</div>
<pre><code> [1] 2.302910e+00 1.584479e+00 1.340323e+00 1.075565e+00 1.069769e+00
 [6] 1.030516e+00 1.016871e+00 1.010250e+00 9.918398e-01 9.523231e-01
[11] 8.177492e-01 7.220271e-01 6.572256e-01 5.051892e-01 3.819642e-01
[16] 2.407648e-01 7.909304e-16 5.681418e-16 1.936857e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var</span> <span class='op'>&lt;-</span> <span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var</span>
</code></pre>
</div>
<pre><code> [1] 5.303392e+00 2.510573e+00 1.796467e+00 1.156841e+00 1.144405e+00
 [6] 1.061964e+00 1.034026e+00 1.020604e+00 9.837462e-01 9.069192e-01
[11] 6.687138e-01 5.213231e-01 4.319455e-01 2.552161e-01 1.458967e-01
[16] 5.796769e-02 6.255709e-31 3.227851e-31 3.751413e-32</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve</span> <span class='op'>&lt;-</span> <span class='va'>pr.var</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var</span><span class='op'>)</span>

<span class='va'>pve</span>
</code></pre>
</div>
<pre><code> [1] 2.791259e-01 1.321354e-01 9.455088e-02 6.088635e-02 6.023184e-02
 [6] 5.589284e-02 5.442242e-02 5.371600e-02 5.177612e-02 4.773259e-02
[11] 3.519546e-02 2.743806e-02 2.273397e-02 1.343243e-02 7.678773e-03
[16] 3.050931e-03 3.292478e-32 1.698869e-32 1.974428e-33</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pve</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>pve</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Cumulative Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-53-1.png" width="624" /></p>
</div>
<h4 id="label-propagation-1100s">Label Propagation 1100s:</h4>
<p>The first community cluster below is done using label propagation.
This results in 39 groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>23</span><span class='op'>)</span>
<span class='va'>comm.lab</span><span class='op'>&lt;-</span><span class='fu'>label.propagation.community</span><span class='op'>(</span><span class='va'>wars_in_1100s.ig</span><span class='op'>)</span>
<span class='co'>#Inspect clustering object</span>
<span class='co'># igraph::groups(comm.lab)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-55-1.png" width="624" /></p>
</div>
<h4 id="walktrap-1000s-1">Walktrap 1000s:</h4>
<p>Walktrap classification as seen below results in 19 distinct
communities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>238</span><span class='op'>)</span>
<span class='co'>#Run clustering algorithm: fast_greedy</span>
<span class='va'>wars_in_1100s.wt</span><span class='op'>&lt;-</span><span class='fu'>walktrap.community</span><span class='op'>(</span><span class='va'>wars_in_1100s.ig</span><span class='op'>)</span>

<span class='co'>#igraph::groups(wars_in_1000s.wt)</span>
</code></pre>
</div>
</div>
<p>Adding more steps resulted in 19 groups for both 10 and 20 steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Run &amp; inspect clustering algorithm: 10 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig, steps=10)) </span>
<span class='co'>#Run &amp; inspect clustering algorithm: 20 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig ,steps=20))</span>
<span class='co'>#Run &amp; inspect clustering algorithm</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-58-1.png" width="624" /></p>
</div>
<h4 id="principal-components-1200s">Principal Components 1200s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>total_1100s</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>24</span><span class='op'>]</span><span class='op'>)</span>

<span class='va'>total_1100s_brokerag_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg_binom</span> <span class='op'>&lt;-</span> <span class='va'>total_1100s_brokerag_reg</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg_binom</span>
</code></pre>
</div>
<pre><code>     Catholic      Islam   Orthodox   Buddhist      Pagan Tengrism
1  -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
2  -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
3  -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
4   0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
5  -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
6  -1.1664160 -0.4307277  4.7445259 -0.2085506 -0.3411871      NaN
7  -1.1664160 -0.4307277  4.7445259 -0.2085506 -0.3411871      NaN
8   0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
9  -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
10  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
11  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
12  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
13  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
14  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
15  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
16  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
17  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
18  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
19  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
20 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
21 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
22  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
23  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
24  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
25  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
26  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
27  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
28  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
29 -1.1664160 -0.4307277 -0.2085506  4.7445259 -0.3411871      NaN
30  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
31  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
32  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
33 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
34 -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
35 -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
36 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
37 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
38  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
39  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
40 -1.1664160 -0.4307277  4.7445259 -0.2085506 -0.3411871      NaN
41  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
42  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
43  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
44  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
45 -1.1664160 -0.4307277  4.7445259 -0.2085506 -0.3411871      NaN
46 -1.1664160 -0.4307277 -0.2085506  4.7445259 -0.3411871      NaN
47  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
48  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
49  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
50  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
51  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
52  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
53 -1.1664160 -0.4307277 -0.2085506  4.7445259 -0.3411871      NaN
54  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
55  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
56  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
57  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
58 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
59  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
60  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
61 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
62  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
63  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
64 -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
65 -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
66  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
67 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
68 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
69  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
70 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
71  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
72  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
73 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
74  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
75  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
76  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
77 -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
78 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
79 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
80 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
81 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
82 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
83  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
84 -1.1664160 -0.4307277 -0.2085506  4.7445259 -0.3411871      NaN
85  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
86 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
87  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
88 -1.1664160 -0.4307277 -0.2085506 -0.2085506  2.9000907      NaN
89  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
90 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
91 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
92 -1.1664160 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
93  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
94  0.8483026 -0.4307277 -0.2085506 -0.2085506 -0.3411871      NaN
95 -1.1664160  2.2972142 -0.2085506 -0.2085506 -0.3411871      NaN
       Shinto Shamanism   totdegree   indegree   outdegree
1  -0.2085506       NaN  0.98653288 -0.8115672  1.78663316
2  -0.2085506       NaN  0.98653288 -0.8115672  1.78663316
3  -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
4  -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
5  -0.2085506       NaN  2.52925920  2.4278818  1.31776534
6  -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
7  -0.2085506       NaN  2.52925920  4.0476064  0.14559580
8  -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
9  -0.2085506       NaN -0.55619344 -0.1636774 -0.55770593
10 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
11 -0.2085506       NaN  0.02232893  0.8081573 -0.55770593
12 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
13 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
14 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
15 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
16 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
17 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
18 -0.2085506       NaN -0.36335265 -0.4876223 -0.08883811
19 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
20 -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
21 -0.2085506       NaN  1.56505525 -0.8115672  2.48993488
22 -0.2085506       NaN  0.79369209 -0.8115672  1.55219925
23 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
24 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
25 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
26 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
27 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
28 -0.2085506       NaN  0.02232893 -0.8115672  0.61446361
29 -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
30 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
31 -0.2085506       NaN  1.95073683  0.8081573  1.78663316
32 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
33 -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
34 -0.2085506       NaN -0.55619344 -0.1636774 -0.55770593
35 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
36 -0.2085506       NaN  2.33641841  1.4560471  1.78663316
37 -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
38 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
39 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
40 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
41 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
42 -0.2085506       NaN  1.37221446  1.7799920  0.38002970
43 -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
44 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
45 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
46 -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
47 -0.2085506       NaN  0.02232893  0.8081573 -0.55770593
48 -0.2085506       NaN  1.37221446  2.1039369  0.14559580
49 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
50 -0.2085506       NaN  3.49346315  2.7518267  2.25550097
51 -0.2085506       NaN  0.02232893  0.8081573 -0.55770593
52 -0.2085506       NaN -0.17051186 -0.8115672  0.38002970
53 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
54 -0.2085506       NaN  0.02232893  0.8081573 -0.55770593
55 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
56 -0.2085506       NaN  0.60085130  0.8081573  0.14559580
57 -0.2085506       NaN -0.17051186 -0.4876223  0.14559580
58 -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
59 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
60 -0.2085506       NaN  0.21516972 -0.8115672  0.84889752
61 -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
62 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
63 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
64  4.7445259       NaN -0.55619344 -0.8115672 -0.08883811
65  4.7445259       NaN -0.74903423 -0.4876223 -0.55770593
66 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
67 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
68 -0.2085506       NaN -0.17051186  0.4842124 -0.55770593
69 -0.2085506       NaN  0.02232893  0.1602675 -0.08883811
70 -0.2085506       NaN -0.17051186  0.4842124 -0.55770593
71 -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
72 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
73 -0.2085506       NaN -0.17051186  0.4842124 -0.55770593
74 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
75 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
76 -0.2085506       NaN  0.21516972 -0.4876223  0.61446361
77  4.7445259       NaN -0.74903423 -0.4876223 -0.55770593
78 -0.2085506       NaN  1.56505525 -0.8115672  2.48993488
79 -0.2085506       NaN -0.74903423 -0.8115672 -0.32327202
80 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
81 -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
82 -0.2085506       NaN  0.60085130  1.7799920 -0.55770593
83 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
84 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
85 -0.2085506       NaN -0.55619344 -0.8115672 -0.08883811
86 -0.2085506       NaN  3.49346315 -0.8115672  4.83427397
87 -0.2085506       NaN  0.79369209 -0.8115672  1.55219925
88 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
89 -0.2085506       NaN  1.95073683 -0.8115672  2.95880270
90 -0.2085506       NaN  0.02232893  0.8081573 -0.55770593
91 -0.2085506       NaN -0.36335265  0.1602675 -0.55770593
92  4.7445259       NaN -0.74903423 -0.4876223 -0.55770593
93 -0.2085506       NaN  0.79369209 -0.8115672  1.55219925
94 -0.2085506       NaN -0.74903423 -0.4876223 -0.55770593
95 -0.2085506       NaN  2.14357762  1.1321022  1.78663316
         eigen          rc    eigen.rc          dc    eigen.dc
1   1.90742914 -0.72419992 -0.22724308  0.72419992  2.47307792
2   1.90742914 -0.72419992 -0.22724308  0.72419992  2.47307792
3  -0.37522636  0.33072090 -0.22724308 -0.33072090 -0.39873052
4  -0.37522636  3.36361826 -0.22724308 -3.36361826 -0.39873052
5   5.00123450  0.58390190  6.47934055 -0.58390190  4.20087406
6  -0.34813305 -0.72419992 -0.22724308  0.72419992 -0.36464443
7  -0.22558046 -0.25465323 -0.16023813  0.25465323 -0.23208659
8  -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
9  -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
10 -0.37522636  0.09336372 -0.22724308 -0.09336372 -0.39873052
11 -0.37522636 -0.39976990 -0.22724308  0.39976990 -0.39873052
12 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
13 -0.37522636 -0.31541810 -0.22724308  0.31541810 -0.39873052
14 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
15 -0.37522636 -0.31541810 -0.22724308  0.31541810 -0.39873052
16 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
17 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
18  0.03804718 -0.21322264 -0.02586951  0.21322264  0.05621642
19 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
20 -0.37522636 -0.17915749 -0.22724308  0.17915749 -0.39873052
21  0.34002682 -0.72419992 -0.22724308  0.72419992  0.50112937
22 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
23 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
24 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
25 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
26 -0.37522636 -0.31541810 -0.22724308  0.31541810 -0.39873052
27 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
28 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
29 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
30 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
31  1.29450849 -0.39976990  0.28933008  0.39976990  1.53524090
32 -0.37522636 -0.31541810 -0.22724308  0.31541810 -0.39873052
33 -0.37522636 -0.17915749 -0.22724308  0.17915749 -0.39873052
34 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
35 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
36  1.90742914  0.45497840  2.33950452 -0.45497840  1.64467164
37  0.63390869 -0.72419992 -0.22724308  0.72419992  0.87086209
38 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
39 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
40 -0.37522636  0.63840614 -0.22724308 -0.63840614 -0.39873052
41 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
42  2.01195113 -0.35921615  0.60360489  0.35921615  2.33642456
43 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
44 -0.37522636  3.36361826 -0.22724308 -3.36361826 -0.39873052
45 -0.37522636 -0.31541810 -0.22724308  0.31541810 -0.39873052
46 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
47 -0.37522636 -0.39976990 -0.22724308  0.39976990 -0.39873052
48  1.03854581 -0.35562615  0.26965481  0.35562615  1.21956440
49 -0.37522636  0.63840614 -0.22724308 -0.63840614 -0.39873052
50  5.19858238  0.49428435  6.24918123 -0.49428435  4.52344028
51 -0.37522636 -0.39976990 -0.22724308  0.39976990 -0.39873052
52  0.03804718 -0.72419992 -0.22724308  0.72419992  0.12120884
53 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
54 -0.37522636 -0.39976990 -0.22724308  0.39976990 -0.39873052
55 -0.37522636 -0.31541810 -0.22724308  0.31541810 -0.39873052
56  1.03854581 -0.39976990  0.21014179  0.39976990  1.23877197
57  1.03854581 -0.21322264  0.46163809  0.21322264  1.15760266
58 -0.37522636 -0.17915749 -0.22724308  0.17915749 -0.39873052
59 -0.37522636  0.09336372 -0.22724308 -0.09336372 -0.39873052
60 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
61 -0.37522636 -0.17915749 -0.22724308  0.17915749 -0.39873052
62 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
63 -0.37522636  0.09336372 -0.22724308 -0.09336372 -0.39873052
64 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
65 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
66 -0.37522636  0.09336372 -0.22724308 -0.09336372 -0.39873052
67 -0.37522636  3.36361826 -0.22724308 -3.36361826 -0.39873052
68 -0.37522636 -0.33488390 -0.22724308  0.33488390 -0.39873052
69 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
70 -0.37522636 -0.33488390 -0.22724308  0.33488390 -0.39873052
71 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
72 -0.37522636 -0.21322264 -0.22724308  0.21322264 -0.39873052
73 -0.37522636 -0.33488390 -0.22724308  0.33488390 -0.39873052
74 -0.37522636 -0.47392533 -0.22724308  0.47392533 -0.39873052
75 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
76  0.45132072  0.63840614  0.84674934 -0.63840614  0.29452196
77 -0.37522636  3.36361826 -0.22724308 -3.36361826 -0.39873052
78  0.34002682 -0.72419992 -0.22724308  0.72419992  0.50112937
79 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
80 -0.37522636 -0.07875494 -0.22724308  0.07875494 -0.39873052
81 -0.37522636 -0.17915749 -0.22724308  0.17915749 -0.39873052
82 -0.37522636 -0.17915749 -0.22724308  0.17915749 -0.39873052
83 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
84 -0.37522636  3.36361826 -0.22724308 -3.36361826 -0.39873052
85 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
86  2.62268232 -0.72419992 -0.22724308  0.72419992  3.37293781
87 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
88 -0.37522636  0.29775463 -0.22724308 -0.29775463 -0.39873052
89 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
90 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
91 -0.37522636 -0.14022589 -0.22724308  0.14022589 -0.39873052
92 -0.37522636  1.31970917 -0.22724308 -1.31970917 -0.39873052
93 -0.37522636 -0.72419992 -0.22724308  0.72419992 -0.39873052
94 -0.37522636  0.09336372 -0.22724308 -0.09336372 -0.39873052
95  1.90742914 -0.02343109  1.29813835  0.02343109  1.98076790
    broker.tot broker.coord broker.itin   broker.rep broker.gate
1  -0.28212528          NaN  -0.3935063  0.008838063  0.69911295
2  -0.28212528          NaN  -0.3935063  0.008838063  0.69911295
3  -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
4  -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
5   3.48290374          NaN  -0.3935063  0.008838063  0.69911295
6  -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
7   2.58950702          NaN   3.0198591  0.008838063  0.69911295
8  -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
9  -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
10 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
11 -0.28212528    0.9731976  -0.3622465 -0.063522566  0.17451118
12 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
13 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
14 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
15 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
16 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
17 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
18 -0.15449718    0.4451016  -0.2979929 -0.102890547  1.88690308
19 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
20 -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
21 -0.28212528          NaN  -0.3935063  0.008838063  0.69911295
22 -0.28212528    1.4816345  -0.3902185 -0.012425931  0.54495276
23 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
24 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
25 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
26 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
27 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
28 -0.28212528    0.9731976  -0.3622465 -0.063522566  0.17451118
29 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
30 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
31  2.20662271          NaN  -0.3935063  0.008838063  0.69911295
32 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
33 -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
34 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
35 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
36  3.80197399          NaN  -0.3951848          NaN         NaN
37 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
38 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
39 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
40 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
41 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
42  1.18559790          NaN  -0.3935063  0.008838063  0.69911295
43 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
44 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
45 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
46 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
47 -0.28212528    0.9731976  -0.3622465 -0.063522566  0.17451118
48  0.67508549          NaN  -0.3935063  0.008838063  0.69911295
49 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
50  6.29072198          NaN   8.1399073  9.518430068  0.69911295
51 -0.28212528    0.9731976  -0.3622465 -0.063522566  0.17451118
52 -0.28212528    1.2141171  -0.3790760 -0.041775533  0.33217333
53 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
54 -0.28212528    0.9731976  -0.3622465 -0.063522566  0.17451118
55 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
56  0.29220118    0.8599651  -0.3518366 -0.072759016  0.10754855
57 -0.15449718    1.2141171   1.3332521 -0.041775533  0.33217333
58 -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
59 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
60 -0.28212528    1.3434408  -0.3853874 -0.028473677  0.42860943
61 -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
62 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
63 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
64 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
65 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
66 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
67 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
68 -0.28212528    1.2141171  -0.3790760 -0.041775533  0.33217333
69  0.10075903    0.9731976  -0.3622465 -0.063522566  8.06098374
70 -0.28212528    1.2141171  -0.3790760 -0.041775533  0.33217333
71 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
72 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
73 -0.28212528    1.2141171  -0.3790760 -0.041775533  0.33217333
74 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
75 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
76  0.03694498    1.3434408  -0.3853874 -0.028473677  0.42860943
77 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
78 -0.28212528          NaN  -0.3935063  0.008838063  0.69911295
79 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
80 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
81 -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
82 -0.28212528    0.8599651  -0.3518366 -0.072759016  0.10754855
83 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
84 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
85 -0.28212528    0.5437440  -0.3132009 -0.096175274 -0.06221518
86 -0.28212528          NaN  -0.3935063  0.008838063  0.69911295
87 -0.28212528    1.4816345  -0.3902185 -0.012425931  0.54495276
88 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
89 -0.28212528          NaN  -0.3935063  0.008838063  0.69911295
90 -0.28212528    0.9731976  -0.3622465 -0.063522566  0.17451118
91 -0.28212528    0.4451016  -0.2979929 -0.102890547 -0.11089972
92 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
93 -0.28212528    1.4816345  -0.3902185 -0.012425931  0.54495276
94 -0.28212528   -1.1580872   0.1408909 -0.181612160 -0.68161750
95  2.78094917          NaN   3.0171067          NaN         NaN
    broker.lia    win_rate   loss_rate more_win_or_loss
1  -0.32122953   1.8110224  -0.8226459                1
2  -0.32122953   1.8110224  -0.8226459                1
3  -0.30702105  -0.9281929   2.9624501                0
4  -0.25402624   0.7445667   0.6510014                1
5   3.79353719   0.5210084   0.9599182                1
6  -0.25402624   0.4315851   1.0834849                0
7   2.67766825   0.0575646   1.6003130                0
8  -0.29971771   0.1597252   1.4591457                0
9  -0.29971771   1.0027194   0.2942815                1
10 -0.25402624   0.7445667   0.6510014                1
11 -0.30943116 -24.9768279  36.1932777                0
12 -0.29726654   1.5348889  -0.4410797                1
13 -0.25402624   0.7445667   0.6510014                1
14 -0.29726654   1.5348889  -0.4410797                1
15 -0.25402624   0.7445667   0.6510014                1
16 -0.29726654   1.5348889  -0.4410797                1
17 -0.29971771   0.1597252   1.4591457                0
18 -0.21411492   0.2444956   1.3420085                0
19 -0.29726654   1.5348889  -0.4410797                1
20 -0.30702105  -0.9281929   2.9624501                0
21 -0.32122953   1.5909565  -0.5185550                1
22 -0.31890697   1.9556693  -1.0225215                1
23 -0.29726654   1.5348889  -0.4410797                1
24 -0.29726654   1.5348889  -0.4410797                1
25 -0.25402624   0.7445667   0.6510014                1
26 -0.25402624   0.7445667   0.6510014                1
27 -0.29726654   1.5348889  -0.4410797                1
28 -0.30943116  27.5187174 -36.3459920                1
29 -0.25402624   0.4315851   1.0834849                0
30 -0.25402624   0.7445667   0.6510014                1
31  2.39870102   0.9158761   0.4142831                1
32 -0.25402624   0.7445667   0.6510014                1
33 -0.30702105  -0.9281929   2.9624501                0
34 -0.29971771   1.0027194   0.2942815                1
35 -0.29971771   0.1597252   1.4591457                0
36  4.06076473   0.7646889   0.6231962                1
37 -0.25402624   0.4315851   1.0834849                0
38 -0.25402624   0.7445667   0.6510014                1
39 -0.29971771   0.1597252   1.4591457                0
40 -0.25402624   0.7445667   0.6510014                1
41 -0.25402624   0.7445667   0.6510014                1
42  1.28283207   0.2769463   1.2971675                0
43 -0.25402624   0.4315851   1.0834849                0
44 -0.25402624   0.7445667   0.6510014                1
45 -0.25402624   0.7445667   0.6510014                1
46 -0.25402624   0.4315851   1.0834849                0
47 -0.30943116 -24.9768279  36.1932777                0
48  0.72489760   0.1061028   1.5332421                0
49 -0.25402624   0.7445667   0.6510014                1
50  5.74630784   0.6456347   0.7877074                1
51 -0.30943116 -24.9768279  36.1932777                0
52 -0.31420441  -2.2287582   4.7595942                0
53 -0.29971771   0.1597252   1.4591457                0
54 -0.30943116 -24.9768279  36.1932777                0
55 -0.25402624   0.7445667   0.6510014                1
56  0.39119238   0.2423159   1.3450205                0
57 -0.24062959  -0.8538749   2.8597562                0
58 -0.30702105  -0.9281929   2.9624501                0
59 -0.25402624   0.7445667   0.6510014                1
60 -0.31656502   3.9452461  -3.7717539                1
61 -0.30702105  -0.9281929   2.9624501                0
62 -0.29726654   1.5348889  -0.4410797                1
63 -0.25402624   0.7445667   0.6510014                1
64 -0.29971771   0.1597252   1.4591457                0
65 -0.25402624   0.7445667   0.6510014                1
66 -0.25402624   0.7445667   0.6510014                1
67 -0.25402624   0.7445667   0.6510014                1
68 -0.31420441   3.2707751  -2.8397579                1
69 -0.08075180  -3.9786097   7.1775698                0
70 -0.31420441   3.2707751  -2.8397579                1
71 -0.25402624   0.4315851   1.0834849                0
72 -0.25402624   0.7445667   0.6510014                1
73 -0.31420441   3.2707751  -2.8397579                1
74 -0.29726654   1.5348889  -0.4410797                1
75 -0.29971771   0.1597252   1.4591457                0
76  0.04482169   2.8557160  -2.2662219                1
77 -0.25402624   0.7445667   0.6510014                1
78 -0.32122953   1.5909565  -0.5185550                1
79 -0.25402624   0.4315851   1.0834849                0
80 -0.29726654   1.5348889  -0.4410797                1
81 -0.30702105  -0.9281929   2.9624501                0
82 -0.30702105  -0.9281929   2.9624501                0
83 -0.29971771   0.1597252   1.4591457                0
84 -0.25402624   0.7445667   0.6510014                1
85 -0.29971771   0.1597252   1.4591457                0
86 -0.32122953   1.3838056  -0.2323102                1
87 -0.31890697   1.9556693  -1.0225215                1
88 -0.25402624   0.7445667   0.6510014                1
89 -0.32122953   1.5167616  -0.4160311                1
90 -0.30943116 -24.9768279  36.1932777                0
91 -0.29726654   1.5348889  -0.4410797                1
92 -0.25402624   0.7445667   0.6510014                1
93 -0.31890697   1.9556693  -1.0225215                1
94 -0.25402624   0.7445667   0.6510014                1
95  2.82768123   0.8334819   0.5281368                1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1100s_brokerag_reg_binom</span><span class='op'>[</span>,<span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>16</span><span class='op'>:</span><span class='fl'>23</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
    0.000000e+00    -7.317509e-18    -7.278706e-18     3.509791e-17 
        Tengrism           Shinto        Shamanism        totdegree 
             NaN    -7.370007e-18              NaN    -3.456208e-17 
        indegree        outdegree            eigen               rc 
    6.658371e-17     2.657893e-17    -2.451438e-17     6.162263e-17 
        eigen.rc               dc        loss_rate more_win_or_loss 
    1.642281e-18    -1.015857e-16     2.136940e+00     6.210526e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
       1.0000000        1.0000000        1.0000000        1.0000000 
        Tengrism           Shinto        Shamanism        totdegree 
              NA        1.0000000               NA        1.0000000 
        indegree        outdegree            eigen               rc 
       1.0000000        1.0000000        1.0000000        1.0000000 
        eigen.rc               dc        loss_rate more_win_or_loss 
       1.0000000        1.0000000       81.7326375        0.2378499 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>total_1200s</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;name&quot;         &quot;Catholic&quot;     &quot;Islam&quot;        &quot;Orthodox&quot;    
 [5] &quot;Buddhist&quot;     &quot;Pagan&quot;        &quot;Tengrism&quot;     &quot;Shinto&quot;      
 [9] &quot;Hindu&quot;        &quot;Shamanism&quot;    &quot;totdegree&quot;    &quot;indegree&quot;    
[13] &quot;outdegree&quot;    &quot;eigen&quot;        &quot;rc&quot;           &quot;eigen.rc&quot;    
[17] &quot;dc&quot;           &quot;eigen.dc&quot;     &quot;broker.tot&quot;   &quot;broker.coord&quot;
[21] &quot;broker.itin&quot;  &quot;broker.rep&quot;   &quot;broker.gate&quot;  &quot;broker.lia&quot;  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>total_1200s</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>24</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>total_1200s_brokerag_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1200s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_brokerag_reg_binom</span> <span class='op'>&lt;-</span> <span class='va'>total_1200s_brokerag_reg</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1200s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1200s_brokerag_reg_binom</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>7</span>,<span class='fl'>9</span>, <span class='fl'>18</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>]</span>


<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
    7.312605e-18     1.663979e-17     1.673737e-17    -6.715193e-18 
        Tengrism            Hindu        totdegree         indegree 
   -3.405970e-17    -7.085007e-18    -1.287473e-17     6.660591e-18 
       outdegree            eigen               rc         eigen.rc 
    4.363914e-19    -1.401670e-18    -4.447634e-17     1.009291e-17 
              dc         eigen.dc more_win_or_loss 
   -3.696350e-17     1.313274e-17     6.625000e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
           1.000            1.000            1.000            1.000 
        Tengrism            Hindu        totdegree         indegree 
           1.000            1.000            1.000            1.000 
       outdegree            eigen               rc         eigen.rc 
           1.000            1.000            1.000            1.000 
              dc         eigen.dc more_win_or_loss 
           1.000            1.000            0.225 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># I cannot scale variables with </span>

<span class='va'>total_1200s_for_PCA</span><span class='op'>&lt;-</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>total_1200s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>center</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
    7.285839e-18     1.665335e-17     1.665335e-17    -6.765422e-18 
        Tengrism            Hindu         indegree            eigen 
   -3.400058e-17    -7.025630e-18     6.635317e-18    -1.387779e-18 
              rc         eigen.rc               dc         eigen.dc 
   -4.446855e-17     1.006140e-17    -3.693335e-17     1.309716e-17 
more_win_or_loss 
    6.625000e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>scale</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
       1.0000000        1.0000000        1.0000000        1.0000000 
        Tengrism            Hindu         indegree            eigen 
       1.0000000        1.0000000        1.0000000        1.0000000 
              rc         eigen.rc               dc         eigen.dc 
       1.0000000        1.0000000        1.0000000        1.0000000 
more_win_or_loss 
       0.4743416 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-78-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> 

<span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-79-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>8192</span><span class='op'>)</span>
<span class='fu'>ggbiplot</span><span class='op'>(</span><span class='va'>pr.out_2</span>, labels <span class='op'>=</span>  <span class='va'>total_1200s</span><span class='op'>$</span><span class='va'>name</span>, labels.size  <span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Principal Components 1200s"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-80-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span>
</code></pre>
</div>
<pre><code> [1] 2.302910e+00 1.584479e+00 1.340323e+00 1.075565e+00 1.069769e+00
 [6] 1.030516e+00 1.016871e+00 1.010250e+00 9.918398e-01 9.523231e-01
[11] 8.177492e-01 7.220271e-01 6.572256e-01 5.051892e-01 3.819642e-01
[16] 2.407648e-01 7.909304e-16 5.681418e-16 1.936857e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var_2</span>
</code></pre>
</div>
<pre><code> [1] 3.021651e+00 2.295685e+00 1.325565e+00 1.095347e+00 1.022483e+00
 [6] 1.012110e+00 9.158655e-01 8.325242e-01 7.633394e-01 5.593463e-01
[11] 1.560838e-01 3.766980e-30 1.776587e-31</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.var_2</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var_2</span><span class='op'>)</span>

<span class='va'>pve_2</span>
</code></pre>
</div>
<pre><code> [1] 2.324347e-01 1.765911e-01 1.019665e-01 8.425747e-02 7.865256e-02
 [6] 7.785464e-02 7.045120e-02 6.404033e-02 5.871841e-02 4.302663e-02
[11] 1.200645e-02 2.897677e-31 1.366605e-32</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pve_2</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>pve_2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Cumulative Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-84-1.png" width="624" /></p>
</div>
<h4 id="label-propagation-1200s">Label Propagation 1200s:</h4>
<p>The first community cluster below is done using label propagation.
This results in 39 groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>23</span><span class='op'>)</span>
<span class='va'>comm.lab</span><span class='op'>&lt;-</span><span class='fu'>label.propagation.community</span><span class='op'>(</span><span class='va'>wars_in_1200s.ig</span><span class='op'>)</span>
<span class='co'>#Inspect clustering object</span>
<span class='co'># igraph::groups(comm.lab)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-86-1.png" width="624" /></p>
</div>
<h4 id="walktrap-1200s">Walktrap 1200s:</h4>
<p>Walktrap classification as seen below results in 19 distinct
communities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>238</span><span class='op'>)</span>
<span class='co'>#Run clustering algorithm: fast_greedy</span>
<span class='va'>wars_in_1200s.wt</span><span class='op'>&lt;-</span><span class='fu'>walktrap.community</span><span class='op'>(</span><span class='va'>wars_in_1200s.ig</span><span class='op'>)</span>

<span class='co'>#igraph::groups(wars_in_1000s.wt)</span>
</code></pre>
</div>
</div>
<p>Adding more steps resulted in 19 groups for both 10 and 20 steps.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Run &amp; inspect clustering algorithm: 10 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig, steps=10)) </span>
<span class='co'>#Run &amp; inspect clustering algorithm: 20 steps</span>
<span class='co'>#igraph::groups(walktrap.community(wars_in_1000s.ig ,steps=20))</span>
<span class='co'>#Run &amp; inspect clustering algorithm</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-89-1.png" width="624" /></p>
</div>
<h4 id="principal-components-1100s">Principal Components 1100s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>total_1100s</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;name&quot;         &quot;Catholic&quot;     &quot;Islam&quot;        &quot;Orthodox&quot;    
 [5] &quot;Buddhist&quot;     &quot;Pagan&quot;        &quot;Tengrism&quot;     &quot;Shinto&quot;      
 [9] &quot;Hindu&quot;        &quot;Shamanism&quot;    &quot;totdegree&quot;    &quot;indegree&quot;    
[13] &quot;outdegree&quot;    &quot;eigen&quot;        &quot;rc&quot;           &quot;eigen.rc&quot;    
[17] &quot;dc&quot;           &quot;eigen.dc&quot;     &quot;broker.tot&quot;   &quot;broker.coord&quot;
[21] &quot;broker.itin&quot;  &quot;broker.rep&quot;   &quot;broker.gate&quot;  &quot;broker.lia&quot;  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>total_1100s</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>24</span><span class='op'>]</span><span class='op'>)</span>

<span class='va'>total_1100s_brokerag_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>win_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>outdegree</span><span class='op'>/</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>loss_rate</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>indegree</span><span class='op'>/</span><span class='va'>total_1100s_brokerag_reg</span><span class='op'>$</span><span class='va'>totdegree</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_brokerag_reg_binom</span> <span class='op'>&lt;-</span> <span class='va'>total_1100s_brokerag_reg</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>more_win_or_loss <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
  <span class='va'>win_rate</span> <span class='op'>&lt;</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>0</span>,
    <span class='va'>win_rate</span> <span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>~</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>total_1100s_for_PCA</span> <span class='op'>&lt;-</span> <span class='va'>total_1100s_brokerag_reg_binom</span><span class='op'>[</span>,<span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>16</span><span class='op'>:</span><span class='fl'>24</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>mean</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
    0.000000e+00    -7.317509e-18    -7.278706e-18     3.509791e-17 
        Tengrism           Shinto        Shamanism        totdegree 
             NaN    -7.370007e-18              NaN    -3.456208e-17 
        indegree        outdegree            eigen               rc 
    6.658371e-17     2.657893e-17    -2.451438e-17     6.162263e-17 
        eigen.rc               dc more_win_or_loss 
    1.642281e-18    -1.015857e-16     6.210526e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>var</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           Islam         Orthodox         Buddhist            Pagan 
       1.0000000        1.0000000        1.0000000        1.0000000 
        Tengrism           Shinto        Shamanism        totdegree 
              NA        1.0000000               NA        1.0000000 
        indegree        outdegree            eigen               rc 
       1.0000000        1.0000000        1.0000000        1.0000000 
        eigen.rc               dc more_win_or_loss 
       1.0000000        1.0000000        0.2378499 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span><span class='op'>(</span><span class='va'>total_1100s_for_PCA</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pr.out_2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>center</span>
</code></pre>
</div>
<pre><code>        Catholic            Islam         Orthodox         Buddhist 
   -5.843279e-17     0.000000e+00    -7.304099e-18    -7.304099e-18 
           Pagan           Shinto        totdegree         indegree 
    3.505967e-17    -7.304099e-18    -3.458491e-17     6.661338e-17 
       outdegree            eigen               rc         eigen.rc 
    2.658692e-17    -2.454177e-17     6.161007e-17     1.679943e-18 
              dc more_win_or_loss 
   -1.015635e-16     6.210526e-01 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>scale</span>
</code></pre>
</div>
<pre><code>        Catholic            Islam         Orthodox         Buddhist 
       1.0000000        1.0000000        1.0000000        1.0000000 
           Pagan           Shinto        totdegree         indegree 
       1.0000000        1.0000000        1.0000000        1.0000000 
       outdegree            eigen               rc         eigen.rc 
       1.0000000        1.0000000        1.0000000        1.0000000 
              dc more_win_or_loss 
       1.0000000        0.4876986 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-102-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>rotation</span> 

<span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>=</span> <span class='op'>-</span><span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>x</span>

<span class='fu'><a href='https://rdrr.io/r/stats/biplot.html'>biplot</a></span><span class='op'>(</span><span class='va'>pr.out_2</span>, scale <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-103-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>8192</span><span class='op'>)</span>

<span class='fu'>ggbiplot</span><span class='op'>(</span><span class='va'>pr.out_2</span>, labels <span class='op'>=</span>  <span class='va'>total_1100s_brokerag_reg_binom</span><span class='op'>$</span><span class='va'>name</span>, labels.size  <span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Principal Components 1100s"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-104-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.out</span><span class='op'>$</span><span class='va'>sdev</span>
</code></pre>
</div>
<pre><code> [1] 2.302910e+00 1.584479e+00 1.340323e+00 1.075565e+00 1.069769e+00
 [6] 1.030516e+00 1.016871e+00 1.010250e+00 9.918398e-01 9.523231e-01
[11] 8.177492e-01 7.220271e-01 6.572256e-01 5.051892e-01 3.819642e-01
[16] 2.407648e-01 7.909304e-16 5.681418e-16 1.936857e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pr.var_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.out_2</span><span class='op'>$</span><span class='va'>sdev</span><span class='op'>^</span><span class='fl'>2</span>

<span class='va'>pr.var_2</span>
</code></pre>
</div>
<pre><code> [1] 3.541924e+00 2.413871e+00 1.851184e+00 1.415628e+00 1.088312e+00
 [6] 1.049819e+00 9.222302e-01 7.304070e-01 5.180219e-01 3.306005e-01
[11] 8.820121e-02 4.980040e-02 8.941768e-31 1.871804e-31</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pve_2</span> <span class='op'>&lt;-</span> <span class='va'>pr.var_2</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>pr.var_2</span><span class='op'>)</span>

<span class='va'>pve_2</span>
</code></pre>
</div>
<pre><code> [1] 2.529946e-01 1.724194e-01 1.322275e-01 1.011163e-01 7.773657e-02
 [6] 7.498707e-02 6.587358e-02 5.217193e-02 3.700157e-02 2.361432e-02
[11] 6.300087e-03 3.557171e-03 6.386977e-32 1.337003e-32</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pve_2</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,
type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>pve_2</span><span class='op'>)</span>, xlab <span class='op'>=</span> <span class='st'>"Principal Component"</span>,
ylab <span class='op'>=</span> <span class='st'>"Cumulative Proportion of Variance Explained"</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"b"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-108-1.png" width="624" /></p>
</div>
<h3 id="cug-1000s">CUG 1000s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1000s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"size"</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: size 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 1000 

Observed Value: 0.0984456 
Pr(X&gt;=Obs): 1 
Pr(X&lt;=Obs): 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-110-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>obs.stat</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -88.00188</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cug.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>)</span><span class='op'>{</span>
  <span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>obs.stat</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on size</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1000s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"size"</span>, reps <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: size 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 100 

Observed Value: 0.0984456 
Pr(X&gt;=Obs): 1 
Pr(X&lt;=Obs): 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs. simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-114-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -83.27903</code></pre>
</div>
<h3 id="cug-1100s">CUG 1100s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1100s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"size"</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: size 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 1000 

Observed Value: 0.1388889 
Pr(X&gt;=Obs): 1 
Pr(X&lt;=Obs): 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-117-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>obs.stat</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -67.57014</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cug.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>)</span><span class='op'>{</span>
  <span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>obs.stat</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on size</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1100s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"size"</span>, reps <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: size 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 100 

Observed Value: 0.1388889 
Pr(X&gt;=Obs): 1 
Pr(X&lt;=Obs): 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs. simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-121-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -62.85368</code></pre>
</div>
<h3 id="cug-1200s">CUG 1200s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1200s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"size"</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: size 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 1000 

Observed Value: 0.1111111 
Pr(X&gt;=Obs): 1 
Pr(X&lt;=Obs): 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-124-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>obs.stat</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -120.9757</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cug.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>)</span><span class='op'>{</span>
  <span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>obs.stat</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>cug.object</span><span class='op'>$</span><span class='va'>rep.stat</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on size</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1200s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"size"</span>, reps <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: size 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 100 

Observed Value: 0.1111111 
Pr(X&gt;=Obs): 1 
Pr(X&lt;=Obs): 0 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs. simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-128-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -123.9686</code></pre>
</div>
<h3 id="cug-test-centralization-1000s">CUG Test Centralization
1000s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network degree centralization to null conditional on size</span>
<span class='va'>c.degree.cug</span> <span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1000s</span>,FUN<span class='op'>=</span><span class='va'>centralization</span>,  FUN.arg<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>, mode<span class='op'>=</span><span class='st'>"digraph"</span>, cmode<span class='op'>=</span><span class='st'>"size"</span><span class='op'>)</span> 
<span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>c.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-130-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>c.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -3.691657</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network betweenness centralization to null conditional on size</span>
<span class='va'>b.degree.cug</span> <span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1000s</span>,FUN<span class='op'>=</span><span class='va'>centralization</span>,  FUN.arg<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FUN<span class='op'>=</span><span class='va'>betweenness</span>, cmode<span class='op'>=</span><span class='st'>"directed"</span><span class='op'>)</span>, mode<span class='op'>=</span><span class='st'>"digraph"</span>, cmode<span class='op'>=</span><span class='st'>"size"</span>, reps<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span> 
<span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>b.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-132-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>b.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 52.41828</code></pre>
</div>
<h3 id="cug-test-centralization-1200s">CUG Test Centralization
1200s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network degree centralization to null conditional on size</span>
<span class='va'>c.degree.cug</span> <span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1100s</span>,FUN<span class='op'>=</span><span class='va'>centralization</span>,  FUN.arg<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>, mode<span class='op'>=</span><span class='st'>"digraph"</span>, cmode<span class='op'>=</span><span class='st'>"size"</span><span class='op'>)</span> 
<span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>c.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-134-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>c.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.1300734</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network betweenness centralization to null conditional on size</span>
<span class='va'>b.degree.cug</span> <span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1100s</span>,FUN<span class='op'>=</span><span class='va'>centralization</span>,  FUN.arg<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FUN<span class='op'>=</span><span class='va'>betweenness</span>, cmode<span class='op'>=</span><span class='st'>"directed"</span><span class='op'>)</span>, mode<span class='op'>=</span><span class='st'>"digraph"</span>, cmode<span class='op'>=</span><span class='st'>"size"</span>, reps<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span> 
<span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>b.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-136-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>b.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 29.04174</code></pre>
</div>
<h3 id="cug-test-centralization-1200s-1">CUG Test Centralization
1200s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network degree centralization to null conditional on size</span>
<span class='va'>c.degree.cug</span> <span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1200s</span>,FUN<span class='op'>=</span><span class='va'>centralization</span>,  FUN.arg<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>, mode<span class='op'>=</span><span class='st'>"digraph"</span>, cmode<span class='op'>=</span><span class='st'>"size"</span><span class='op'>)</span> 
<span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>c.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-138-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>c.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] -1.973945</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network betweenness centralization to null conditional on size</span>
<span class='va'>b.degree.cug</span> <span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1200s</span>,FUN<span class='op'>=</span><span class='va'>centralization</span>,  FUN.arg<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>FUN<span class='op'>=</span><span class='va'>betweenness</span>, cmode<span class='op'>=</span><span class='st'>"directed"</span><span class='op'>)</span>, mode<span class='op'>=</span><span class='st'>"digraph"</span>, cmode<span class='op'>=</span><span class='st'>"size"</span>, reps<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span> 
<span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>b.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-140-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>b.degree.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 220.5521</code></pre>
</div>
<h3 id="conditioning-on-different-network-properties-1000s">Conditioning
on Different Network Properties 1000s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on dyads</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1000s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"dyad"</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: dyad.census 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 1000 

Observed Value: 0.0984456 
Pr(X&gt;=Obs): 0 
Pr(X&lt;=Obs): 1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-143-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 11.14202</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on edges (density)</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1000s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"edges"</span>, reps<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: edges 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 100 

Observed Value: 0.0984456 
Pr(X&gt;=Obs): 0 
Pr(X&lt;=Obs): 1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-146-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12.58383</code></pre>
</div>
<h3 id="conditioning-on-different-network-properties-1100s">Conditioning
on Different Network Properties 1100s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on dyads</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1100s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"dyad"</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: dyad.census 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 1000 

Observed Value: 0.1388889 
Pr(X&gt;=Obs): 0 
Pr(X&lt;=Obs): 1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-149-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 16.10525</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on edges (density)</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1100s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"edges"</span>, reps<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: edges 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 100 

Observed Value: 0.1388889 
Pr(X&gt;=Obs): 0 
Pr(X&lt;=Obs): 1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-152-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 17.64935</code></pre>
</div>
<h3 id="conditioning-on-different-network-properties-1200s">Conditioning
on Different Network Properties 1200s</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on dyads</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1200s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"dyad"</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: dyad.census 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 1000 

Observed Value: 0.1111111 
Pr(X&gt;=Obs): 0 
Pr(X&lt;=Obs): 1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-155-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 19.55207</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compare network transitivity to null conditional on edges (density)</span>
<span class='va'>trans.cug</span><span class='op'>&lt;-</span><span class='fu'>cug.test</span><span class='op'>(</span><span class='va'>wars_1200s</span>,FUN<span class='op'>=</span><span class='va'>gtrans</span>,mode<span class='op'>=</span><span class='st'>"digraph"</span>,cmode<span class='op'>=</span><span class='st'>"edges"</span>, reps<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>trans.cug</span>
</code></pre>
</div>
<pre><code>
Univariate Conditional Uniform Graph Test

Conditioning Method: edges 
Graph Type: digraph 
Diagonal Used: FALSE 
Replications: 100 

Observed Value: 0.1111111 
Pr(X&gt;=Obs): 0 
Pr(X&lt;=Obs): 1 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot vs simulation results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-158-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#t-stat between observed and simulated networks</span>
<span class='fu'>cug.t</span><span class='op'>(</span><span class='va'>trans.cug</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 20.27918</code></pre>
</div>
<h3 id="compare-to-simulated-networks">Compare to Simulated
Networks</h3>
<h4 id="simulated-networks-1000s">Simulated Networks 1000s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#create empty dataframe for simulations</span>
<span class='va'>trials</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>, gdens<span class='op'>=</span><span class='cn'>NA</span>, gtrans<span class='op'>=</span><span class='cn'>NA</span>, cent.deg<span class='op'>=</span><span class='cn'>NA</span>, cent.bet<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#as.network(wars_in_1000s)</span>

<span class='va'>wars_in_1000s_2</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1000s</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>19</span>, <span class='fl'>64</span>, <span class='fl'>65</span>, <span class='fl'>71</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='va'>wars_in_1000s_2.stat</span> <span class='op'>&lt;-</span> <span class='fu'>as.network</span><span class='op'>(</span><span class='va'>wars_in_1000s_2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#simulate PA networks and add stats to trials dataframe: size</span>
<span class='kw'>for</span> <span class='op'>(</span> <span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span> <span class='op'>)</span><span class='op'>{</span> 
  <span class='va'>pa.ig</span><span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/sample_pa.html'>sample_pa</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'>network.size</span><span class='op'>(</span><span class='va'>wars_in_1000s_2.stat</span><span class='op'>)</span>, directed<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='va'>pa.stat</span><span class='op'>&lt;-</span><span class='fu'>intergraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/intergraph/man/asNetwork.html'>asNetwork</a></span><span class='op'>(</span><span class='va'>pa.ig</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>&lt;-</span><span class='fu'>gden</span><span class='op'>(</span><span class='va'>pa.stat</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>pa.stat</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>centralization</span><span class='op'>(</span><span class='va'>pa.stat</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>pa.stat</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       id             gdens              gtrans     cent.deg      
 Min.   :  1.00   Min.   :0.009009   Min.   :0   Min.   :0.07347  
 1st Qu.: 25.75   1st Qu.:0.009009   1st Qu.:0   1st Qu.:0.13769  
 Median : 50.50   Median :0.009009   Median :0   Median :0.17438  
 Mean   : 50.50   Mean   :0.009009   Mean   :0   Mean   :0.18631  
 3rd Qu.: 75.25   3rd Qu.:0.009009   3rd Qu.:0   3rd Qu.:0.21107  
 Max.   :100.00   Max.   :0.009009   Max.   :0   Max.   :0.50463  
    cent.bet        
 Min.   :0.0009174  
 1st Qu.:0.0026569  
 Median :0.0042626  
 Mean   :0.0048482  
 3rd Qu.:0.0061481  
 Max.   :0.0155508  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>g</span>, <span class='va'>trials</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>density<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gden</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>)</span><span class='op'>)</span>,
             transitivity<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>)</span><span class='op'>)</span>,
             indegCent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>)</span><span class='op'>)</span>,
             betwCent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Observed"</span>,<span class='st'>"Simulated"</span>, <span class='st'>"SD"</span><span class='op'>)</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>temp</span><span class='op'>$</span><span class='va'>tvalue</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>Observed</span><span class='op'>-</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>Simulated</span><span class='op'>)</span><span class='op'>/</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>SD</span>
  <span class='va'>temp</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plot.sim.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>g</span>,<span class='va'>trials</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>net.stat<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gtrans"</span>,<span class='st'>"cent.deg"</span>,<span class='st'>"cent.bet"</span><span class='op'>)</span>, 
    x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>, 
        <span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>%&gt;%</span>
    <span class='fu'>gather</span><span class='op'>(</span>key<span class='op'>=</span><span class='st'>"net.stat"</span>,value <span class='op'>=</span> <span class='st'>"estimate"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_histogram</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='va'>net.stat</span> <span class='op'>~</span> <span class='va'>.</span>, scales<span class='op'>=</span><span class='st'>"free"</span>, ncol<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_vline</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>temp</span>, <span class='fu'>aes</span><span class='op'>(</span>xintercept<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span>,
               linetype<span class='op'>=</span><span class='st'>"dashed"</span>, size<span class='op'>=</span><span class='fl'>1</span>, colour<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#check for differences from null</span>

<span class='fu'>sim.t</span><span class='op'>(</span>g<span class='op'>=</span><span class='va'>wars_1000s</span>, <span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>               Observed   Simulated          SD    tvalue
density      0.01253071 0.009009009 0.000000000       Inf
transitivity 0.09844560 0.000000000 0.000000000       Inf
indegCent    0.05157025 0.186305785 0.072871174 -1.848955
betwCent     0.01810448 0.004848199 0.002948065  4.496604</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>plot.sim.t</span><span class='op'>(</span><span class='va'>wars_in_1000s_2.stat</span>, <span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-167-1.png" width="624" /></p>
</div>
<h4 id="simulated-networks-1100s">Simulated Networks 1100s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#as.network(wars_in_1100s)</span>

<span class='va'>wars_in_1100s_2</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1100s</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>47</span>, <span class='fl'>61</span>, <span class='fl'>62</span>, <span class='fl'>77</span>, <span class='fl'>78</span>, <span class='fl'>83</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='co'>#as.network(wars_in_1100s_2)</span>

<span class='va'>wars_in_1100s_2_1</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1100s_2</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>178</span>,<span class='fl'>181</span>, <span class='fl'>182</span>, <span class='fl'>184</span>, <span class='fl'>185</span>, <span class='fl'>188</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='co'>#as.network(wars_in_1100s_2_1)</span>

<span class='va'>wars_in_1100s_2_2</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1100s_2_1</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>183</span>, <span class='fl'>202</span>, <span class='fl'>203</span>, <span class='fl'>204</span>, <span class='fl'>205</span>, <span class='fl'>206</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='co'>#as.network(wars_in_1100s_2_2)</span>

<span class='va'>wars_in_1100s_2_3</span><span class='op'>&lt;-</span> <span class='va'>wars_in_1100s_2_2</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>201</span>, <span class='fl'>202</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='va'>wars_in_1100s_2.stat</span> <span class='op'>&lt;-</span> <span class='fu'>as.network</span><span class='op'>(</span><span class='va'>wars_in_1100s_2_3</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#simulate PA networks and add stats to trials dataframe: size</span>
<span class='kw'>for</span> <span class='op'>(</span> <span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span> <span class='op'>)</span><span class='op'>{</span> 
  <span class='va'>pa.ig</span><span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/sample_pa.html'>sample_pa</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'>network.size</span><span class='op'>(</span><span class='va'>wars_in_1100s_2.stat</span><span class='op'>)</span>, directed<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='va'>pa.stat</span><span class='op'>&lt;-</span><span class='fu'>intergraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/intergraph/man/asNetwork.html'>asNetwork</a></span><span class='op'>(</span><span class='va'>pa.ig</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>&lt;-</span><span class='fu'>gden</span><span class='op'>(</span><span class='va'>pa.stat</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>pa.stat</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>centralization</span><span class='op'>(</span><span class='va'>pa.stat</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>pa.stat</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       id             gdens             gtrans     cent.deg      
 Min.   :  1.00   Min.   :0.01031   Min.   :0   Min.   :0.09484  
 1st Qu.: 25.75   1st Qu.:0.01031   1st Qu.:0   1st Qu.:0.14746  
 Median : 50.50   Median :0.01031   Median :0   Median :0.18956  
 Mean   : 50.50   Mean   :0.01031   Mean   :0   Mean   :0.19567  
 3rd Qu.: 75.25   3rd Qu.:0.01031   3rd Qu.:0   3rd Qu.:0.23166  
 Max.   :100.00   Max.   :0.01031   Max.   :0   Max.   :0.37901  
    cent.bet       
 Min.   :0.001162  
 1st Qu.:0.003045  
 Median :0.004794  
 Mean   :0.005423  
 3rd Qu.:0.007267  
 Max.   :0.017632  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>g</span>, <span class='va'>trials</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>density<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gden</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>)</span><span class='op'>)</span>,
             transitivity<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>)</span><span class='op'>)</span>,
             indegCent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>)</span><span class='op'>)</span>,
             betwCent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Observed"</span>,<span class='st'>"Simulated"</span>, <span class='st'>"SD"</span><span class='op'>)</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>temp</span><span class='op'>$</span><span class='va'>tvalue</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>Observed</span><span class='op'>-</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>Simulated</span><span class='op'>)</span><span class='op'>/</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>SD</span>
  <span class='va'>temp</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>cent.bet, cent.deg, gtrans</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plot.sim.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>g</span>,<span class='va'>trials</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>net.stat<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gtrans"</span>,<span class='st'>"cent.deg"</span>,<span class='st'>"cent.bet"</span><span class='op'>)</span>, x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>, <span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>%&gt;%</span>
    <span class='fu'>gather</span><span class='op'>(</span>key<span class='op'>=</span><span class='st'>"net.stat"</span>,value <span class='op'>=</span> <span class='st'>"estimate"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_histogram</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='va'>net.stat</span> <span class='op'>~</span> <span class='va'>.</span>, scales<span class='op'>=</span><span class='st'>"free"</span>, ncol<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_vline</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>temp</span>, <span class='fu'>aes</span><span class='op'>(</span>xintercept<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span>,
               linetype<span class='op'>=</span><span class='st'>"dashed"</span>, size<span class='op'>=</span><span class='fl'>1</span>, colour<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#check for differences from null</span>

<span class='fu'>sim.t</span><span class='op'>(</span>g<span class='op'>=</span><span class='va'>wars_1100s</span>, <span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>               Observed   Simulated          SD    tvalue
density      0.02555842 0.010309278 0.000000000       Inf
transitivity 0.13888889 0.000000000 0.000000000       Inf
indegCent    0.13205295 0.195666233 0.058576476 -1.085987
betwCent     0.01398369 0.005423314 0.003073955  2.784808</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>plot.sim.t</span><span class='op'>(</span><span class='va'>wars_in_1100s_2.stat</span>, <span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-174-1.png" width="624" /></p>
</div>
<h4 id="simulated-networks-1200s">Simulated Networks 1200s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># as.network(wars_in_1200s)</span>

<span class='va'>wars_in_1200s_2</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1200s</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>23</span>, <span class='fl'>93</span>, <span class='fl'>96</span>, <span class='fl'>142</span>, <span class='fl'>163</span>, <span class='fl'>167</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='co'># as.network(wars_in_1200s_2)</span>

<span class='va'>wars_in_1200s_2_1</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1200s_2</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>162</span>, <span class='fl'>189</span>, <span class='fl'>225</span>, <span class='fl'>236</span>, <span class='fl'>302</span>, <span class='fl'>304</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='co'># as.network(wars_in_1200s_2_1)</span>

<span class='va'>wars_in_1200s_2_2</span> <span class='op'>&lt;-</span> <span class='va'>wars_in_1200s_2_1</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>299</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='va'>wars_in_1200s_2.stat</span> <span class='op'>&lt;-</span> <span class='fu'>as.network</span><span class='op'>(</span><span class='va'>wars_in_1200s_2_2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#simulate PA networks and add stats to trials dataframe: size</span>
<span class='kw'>for</span> <span class='op'>(</span> <span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span> <span class='op'>)</span><span class='op'>{</span> 
  <span class='va'>pa.ig</span><span class='op'>&lt;-</span> <span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/sample_pa.html'>sample_pa</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'>network.size</span><span class='op'>(</span><span class='va'>wars_in_1200s_2.stat</span><span class='op'>)</span>, directed<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='va'>pa.stat</span><span class='op'>&lt;-</span><span class='fu'>intergraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/intergraph/man/asNetwork.html'>asNetwork</a></span><span class='op'>(</span><span class='va'>pa.ig</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>&lt;-</span><span class='fu'>gden</span><span class='op'>(</span><span class='va'>pa.stat</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>pa.stat</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>centralization</span><span class='op'>(</span><span class='va'>pa.stat</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>pa.stat</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       id             gdens              gtrans     cent.deg      
 Min.   :  1.00   Min.   :0.006211   Min.   :0   Min.   :0.06922  
 1st Qu.: 25.75   1st Qu.:0.006211   1st Qu.:0   1st Qu.:0.12582  
 Median : 50.50   Median :0.006211   Median :0   Median :0.14469  
 Mean   : 50.50   Mean   :0.006211   Mean   :0   Mean   :0.15997  
 3rd Qu.: 75.25   3rd Qu.:0.006211   3rd Qu.:0   3rd Qu.:0.18871  
 Max.   :100.00   Max.   :0.006211   Max.   :0   Max.   :0.35852  
    cent.bet        
 Min.   :0.0005646  
 1st Qu.:0.0018678  
 Median :0.0028960  
 Mean   :0.0033793  
 3rd Qu.:0.0043615  
 Max.   :0.0125295  </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>g</span>, <span class='va'>trials</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>density<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gden</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gdens</span><span class='op'>)</span><span class='op'>)</span>,
             transitivity<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>gtrans</span><span class='op'>)</span><span class='op'>)</span>,
             indegCent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.deg</span><span class='op'>)</span><span class='op'>)</span>,
             betwCent<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>trials</span><span class='op'>$</span><span class='va'>cent.bet</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Observed"</span>,<span class='st'>"Simulated"</span>, <span class='st'>"SD"</span><span class='op'>)</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>temp</span><span class='op'>$</span><span class='va'>tvalue</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>Observed</span><span class='op'>-</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>Simulated</span><span class='op'>)</span><span class='op'>/</span><span class='va'>temp</span><span class='op'>$</span><span class='va'>SD</span>
  <span class='va'>temp</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plot.sim.t</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>g</span>,<span class='va'>trials</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>temp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>net.stat<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gtrans"</span>,<span class='st'>"cent.deg"</span>,<span class='st'>"cent.bet"</span><span class='op'>)</span>, x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'>gtrans</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>,<span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>degree</span>, cmode<span class='op'>=</span><span class='st'>"indegree"</span><span class='op'>)</span>, <span class='fu'>centralization</span><span class='op'>(</span><span class='va'>g</span>, FUN<span class='op'>=</span><span class='va'>betweenness</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>trials</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>%&gt;%</span>
    <span class='fu'>gather</span><span class='op'>(</span>key<span class='op'>=</span><span class='st'>"net.stat"</span>,value <span class='op'>=</span> <span class='st'>"estimate"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
    <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_histogram</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='va'>net.stat</span> <span class='op'>~</span> <span class='va'>.</span>, scales<span class='op'>=</span><span class='st'>"free"</span>, ncol<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_vline</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>temp</span>, <span class='fu'>aes</span><span class='op'>(</span>xintercept<span class='op'>=</span><span class='va'>x</span><span class='op'>)</span>,
               linetype<span class='op'>=</span><span class='st'>"dashed"</span>, size<span class='op'>=</span><span class='fl'>1</span>, colour<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#check for differences from null</span>

<span class='fu'>sim.t</span><span class='op'>(</span>g<span class='op'>=</span><span class='va'>wars_1100s</span>, <span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>               Observed  Simulated          SD     tvalue
density      0.02555842 0.00621118 0.000000000        Inf
transitivity 0.13888889 0.00000000 0.000000000        Inf
indegCent    0.13205295 0.15996992 0.052300150 -0.5337838
betwCent     0.01398369 0.00337929 0.002025597  5.2351971</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>plot.sim.t</span><span class='op'>(</span><span class='va'>wars_in_1100s_2.stat</span>, <span class='va'>trials</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-181-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wars_1000s_for_equiv_clust</span><span class='op'>&lt;-</span><span class='fu'>as.network</span><span class='op'>(</span><span class='va'>wars_in_1000s_edgelist</span>, matrix.type <span class='op'>=</span> <span class='st'>"edgelist"</span>, directed <span class='op'>=</span> <span class='cn'>TRUE</span>,  hyper <span class='op'>=</span> <span class='cn'>FALSE</span>, loops <span class='op'>=</span> <span class='cn'>FALSE</span>, multiple <span class='op'>=</span> <span class='cn'>FALSE</span>,
                                       bipartite <span class='op'>=</span> <span class='cn'>FALSE</span>, vertex.attrnames<span class='op'>=</span><span class='va'>wars_in_1000s_network</span><span class='op'>%v%</span><span class='st'>"vertex.names"</span><span class='op'>)</span>

<span class='va'>war_1000s.se_hamming</span><span class='op'>&lt;-</span><span class='fu'>equiv.clust</span><span class='op'>(</span><span class='va'>wars_1000s_for_equiv_clust</span>, equiv.fun<span class='op'>=</span><span class='st'>"sedist"</span>, method<span class='op'>=</span><span class='st'>"hamming"</span>, mode<span class='op'>=</span><span class='st'>"graph"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>war_1000s.se_hamming</span>, labels<span class='op'>=</span><span class='va'>war_1000s.se_hamming</span><span class='op'>$</span><span class='va'>glabels</span>,  cex<span class='op'>=</span><span class='fl'>0.3</span>, main<span class='op'>=</span><span class='st'>"Cluster Dendrogram 1000s Hamming"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://ape-package.ird.fr/'>ape</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/andrie/ggdendro'>ggdendro</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>sets</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://talgalili.github.io/dendextend/'>dendextend</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>RColorBrewer</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>29999</span><span class='op'>)</span>

<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>39</span>

<span class='va'>qual_col_pals</span> <span class='op'>=</span> <span class='va'>brewer.pal.info</span><span class='op'>[</span><span class='va'>brewer.pal.info</span><span class='op'>$</span><span class='va'>category</span> <span class='op'>==</span> <span class='st'>'qual'</span>,<span class='op'>]</span>
<span class='va'>col_vector</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='va'>brewer.pal</span>, <span class='va'>qual_col_pals</span><span class='op'>$</span><span class='va'>maxcolors</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>qual_col_pals</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># pie(rep(1,n), col=sample(col_vector, n))</span>


<span class='va'>dd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>wars_1000s</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span><span class='op'>)</span>

<span class='va'>hc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dd</span>, method <span class='op'>=</span> <span class='st'>"complete"</span><span class='op'>)</span>

<span class='va'>hcd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc</span><span class='op'>)</span>
<span class='co'># Default plot</span>
<span class='va'>clus4</span> <span class='op'>=</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/cutree-methods.html'>cutree</a></span><span class='op'>(</span><span class='va'>hcd</span>, <span class='fl'>39</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/as.phylo.html'>as.phylo</a></span><span class='op'>(</span><span class='va'>hcd</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"radial"</span>, tip.color <span class='op'>=</span> <span class='va'>col_vector</span><span class='op'>[</span><span class='va'>clus4</span><span class='op'>]</span>,
     label.offset <span class='op'>=</span> <span class='fl'>0</span>, cex <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-184-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#install.packages("ggdendro")</span>

<span class='va'>dd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>wars_1100s</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span><span class='op'>)</span>

<span class='va'>hc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dd</span>, method <span class='op'>=</span> <span class='st'>"complete"</span><span class='op'>)</span>

<span class='va'>hcd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc</span><span class='op'>)</span>
<span class='co'># Default plot</span>
<span class='va'>clus4</span> <span class='op'>=</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/cutree-methods.html'>cutree</a></span><span class='op'>(</span><span class='va'>hc</span>, <span class='fl'>10</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/as.phylo.html'>as.phylo</a></span><span class='op'>(</span><span class='va'>hcd</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"fan"</span>, tip.color <span class='op'>=</span> <span class='va'>clus4</span>,
     label.offset <span class='op'>=</span> <span class='fl'>1</span>, cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-185-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#install.packages("ggdendro")</span>

<span class='va'>dd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>wars_1200s</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span><span class='op'>)</span>

<span class='va'>hc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dd</span>, method <span class='op'>=</span> <span class='st'>"complete"</span><span class='op'>)</span>

<span class='va'>hcd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc</span><span class='op'>)</span>
<span class='co'># Default plot</span>
<span class='va'>clus4</span> <span class='op'>=</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/cutree-methods.html'>cutree</a></span><span class='op'>(</span><span class='va'>hc</span>, <span class='fl'>3</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/as.phylo.html'>as.phylo</a></span><span class='op'>(</span><span class='va'>hcd</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"fan"</span>, tip.color <span class='op'>=</span> <span class='va'>clus4</span>,
     label.offset <span class='op'>=</span> <span class='fl'>1</span>, cex <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-186-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.sthda.com/english/rpkgs/factoextra'>factoextra</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://sites.google.com/site/malikacharrad/research/nbclust-package'>NbClust</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>wars_1000s</span><span class='op'>)</span>

<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>wars_1000s</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, method <span class='op'>=</span> <span class='st'>"wss"</span><span class='op'>)</span> <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>4</span>, linetype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Elbow method"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-188-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Silhouette method</span>
<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, method <span class='op'>=</span> <span class='st'>"silhouette"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Silhouette method"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-188-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Gap statistic</span>
<span class='co'># nboot = 50 to keep the function speedy. </span>
<span class='co'># recommended value: nboot= 500 for your analysis.</span>
<span class='co'># Use verbose = FALSE to hide computing progression.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, nstart <span class='op'>=</span> <span class='fl'>25</span>,  method <span class='op'>=</span> <span class='st'>"gap_stat"</span>, nboot <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Gap statistic method"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-188-3.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>wars_1100s</span><span class='op'>)</span>

<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>wars_1100s</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, method <span class='op'>=</span> <span class='st'>"wss"</span><span class='op'>)</span> <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>4</span>, linetype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Elbow method"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-189-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Silhouette method</span>
<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, method <span class='op'>=</span> <span class='st'>"silhouette"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Silhouette method"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-189-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Gap statistic</span>
<span class='co'># nboot = 50 to keep the function speedy. </span>
<span class='co'># recommended value: nboot= 500 for your analysis.</span>
<span class='co'># Use verbose = FALSE to hide computing progression.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, nstart <span class='op'>=</span> <span class='fl'>25</span>,  method <span class='op'>=</span> <span class='st'>"gap_stat"</span>, nboot <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Gap statistic method"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-189-3.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>wars_1200s</span><span class='op'>)</span>

<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>wars_1200s</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, method <span class='op'>=</span> <span class='st'>"wss"</span><span class='op'>)</span> <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>4</span>, linetype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Elbow method"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-190-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Silhouette method</span>
<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, method <span class='op'>=</span> <span class='st'>"silhouette"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Silhouette method"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-190-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Gap statistic</span>
<span class='co'># nboot = 50 to keep the function speedy. </span>
<span class='co'># recommended value: nboot= 500 for your analysis.</span>
<span class='co'># Use verbose = FALSE to hide computing progression.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html'>fviz_nbclust</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>kmeans</span>, nstart <span class='op'>=</span> <span class='fl'>25</span>,  method <span class='op'>=</span> <span class='st'>"gap_stat"</span>, nboot <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>subtitle <span class='op'>=</span> <span class='st'>"Gap statistic method"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-190-3.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#install.packages('maps')</span>
<span class='co'>#install.packages('geosphere')</span>
<span class='co'>#install.packages("diagram")</span>
<span class='co'>#install.packages("plotrix")</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'>'maps'</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'>'geosphere'</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>diagram</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>plotrix</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>aspects_of_1000s_for_map</span> <span class='op'>&lt;-</span> <span class='fu'>read_excel</span><span class='op'>(</span><span class='st'>"~/Desktop/Spring 2022/Networks/aspects_of_1000s_for_map.xlsx"</span><span class='op'>)</span>

<span class='va'>cl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html'>colors</a></span><span class='op'>(</span>distinct <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>15887</span><span class='op'>)</span> <span class='co'># to set random generator seed</span>

<span class='va'>mycols2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>cl</span>, <span class='fl'>112</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette</a></span><span class='op'>(</span><span class='va'>mycols2</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/maps/man/map.html'>map</a></span><span class='op'>(</span><span class='st'>'world'</span>, fill <span class='op'>=</span> <span class='cn'>TRUE</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>50</span>, <span class='fl'>160</span><span class='op'>)</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>80</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"white"</span>, mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>, resolution <span class='op'>=</span> <span class='fl'>10</span> ,   myborder <span class='op'>=</span> <span class='fl'>0.001</span><span class='op'>)</span> 

<span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span><span class='op'>(</span><span class='va'>aspects_of_1000s_for_map</span>, countries <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>aspects_of_1000s_for_map</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>nodes</span>, <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>long</span>, <span class='va'>lat</span>, col<span class='op'>=</span><span class='va'>countries</span>, pch<span class='op'>=</span><span class='fl'>19</span>, cex<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>wars_in_1000s</span><span class='op'>$</span><span class='va'>`In-list`</span>, to <span class='op'>=</span> <span class='va'>wars_in_1000s</span><span class='op'>$</span><span class='va'>`Out-list`</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>, <span class='va'>from</span> <span class='op'>!=</span> <span class='va'>to</span><span class='op'>)</span>

<span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>edges</span>, <span class='va'>nodes</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name"</span>, <span class='st'>"long"</span>, <span class='st'>"lat"</span><span class='op'>)</span><span class='op'>]</span>, by.x <span class='op'>=</span> <span class='st'>"from"</span>, by.y <span class='op'>=</span> <span class='st'>"name"</span><span class='op'>)</span>, <span class='va'>nodes</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name"</span>, <span class='st'>"long"</span>, <span class='st'>"lat"</span><span class='op'>)</span><span class='op'>]</span>, by.x <span class='op'>=</span> <span class='st'>"to"</span>, by.y <span class='op'>=</span> <span class='st'>"name"</span><span class='op'>)</span>

<span class='va'>edges</span><span class='op'>$</span><span class='va'>col</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>countries</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>edges</span><span class='op'>$</span><span class='va'>from</span>, <span class='va'>nodes</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>

<span class='va'>edges_2</span><span class='op'>&lt;-</span><span class='va'>edges</span><span class='op'>[</span>, <span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>edges</span><span class='op'>[</span>, <span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/diagram/man/curvedarrow.html'>curvedarrow</a></span><span class='op'>(</span>to<span class='op'>=</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>, from<span class='op'>=</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, lcol<span class='op'>=</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span>, curve<span class='op'>=</span><span class='fl'>.1</span>, arr.pos <span class='op'>=</span> <span class='fl'>1</span>, lwd<span class='op'>=</span><span class='fl'>.2</span>, arr.lwd<span class='op'>=</span><span class='fl'>0.01</span>, 
arr.width<span class='op'>=</span><span class='fl'>0.1</span>, arr.length<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="networks-blog-post-9_files/figure-html5/unnamed-chunk-193-1.png" width="624" /></p>
<pre><code>[[1]]
      ex       ey 
43.81920 34.33171 

[[2]]
      ex       ey 
43.81284 34.31744 

[[3]]
      ex       ey 
43.81401 34.31508 

[[4]]
      ex       ey 
43.82179 34.33579 

[[5]]
      ex       ey 
43.82087 34.32188 

[[6]]
      ex       ey 
43.81908 34.32335 

[[7]]
       ex        ey 
136.50553  34.71798 

[[8]]
       ex        ey 
136.50553  34.71798 

[[9]]
      ex       ey 
45.40862 39.21444 

[[10]]
      ex       ey 
23.31721 42.68510 

[[11]]
      ex       ey 
28.95465 41.01793 

[[12]]
      ex       ey 
28.95424 41.00769 

[[13]]
      ex       ey 
28.95653 41.01618 

[[14]]
      ex       ey 
28.95519 41.01385 

[[15]]
NULL

[[16]]
       ex        ey 
 1.327829 47.593194 

[[17]]
       ex        ey 
 1.328157 47.592716 

[[18]]
      ex       ey 
-8.30090 41.44986 

[[19]]
      ex       ey 
35.21118 31.77996 

[[20]]
      ex       ey 
37.01746 39.73511 

[[21]]
      ex       ey 
37.00943 39.73067 

[[22]]
      ex       ey 
37.01838 39.74902 

[[23]]
      ex       ey 
37.01579 39.74495 

[[24]]
      ex       ey 
37.01567 39.73659 

[[25]]
      ex       ey 
37.01060 39.72831 

[[26]]
       ex        ey 
-6.260424 53.349781 

[[27]]
      ex       ey 
40.81767 43.08484 

[[28]]
      ex       ey 
14.41615 50.07810 

[[29]]
       ex        ey 
-1.554007 47.218186 

[[30]]
       ex        ey 
-1.554007 47.218186 

[[31]]
      ex       ey 
41.81772 41.18361 

[[32]]
      ex       ey 
44.20883 41.74156 

[[33]]
      ex       ey 
14.26004 40.84440 

[[34]]
      ex       ey 
14.25829 40.84544 

[[35]]
      ex       ey 
14.25829 40.84555 

[[36]]
      ex       ey 
14.25826 40.84496 

[[37]]
      ex       ey 
11.23804 51.71675 

[[38]]
       ex        ey 
-2.957508 58.981499 

[[39]]
      ex       ey 
81.78387 16.97828 

[[40]]
      ex       ey 
13.35077 38.11195 

[[41]]
      ex       ey 
13.35077 38.11184 

[[42]]
      ex       ey 
13.35077 38.11195 

[[43]]
      ex       ey 
13.35077 38.11184 

[[44]]
NULL

[[45]]
      ex       ey 
39.72276 40.99871 

[[46]]
       ex        ey 
-1.307406 51.063490 

[[47]]
       ex        ey 
-1.309394 51.067384 

[[48]]
       ex        ey 
-1.307633 51.069872 

[[49]]
       ex        ey 
-1.311385 51.061935 

[[50]]
       ex        ey 
-1.311102 51.061199 

[[51]]
        ex         ey 
 0.4885797 50.9113881 

[[52]]
      ex       ey 
24.93531 60.16173 

[[53]]
      ex       ey 
68.42156 33.54314 

[[54]]
       ex        ey 
126.54616  37.96221 

[[55]]
       ex        ey 
 6.082774 50.774454 

[[56]]
      ex       ey 
 6.08387 50.77991 

[[57]]
      ex       ey 
11.43144 48.77979 

[[58]]
       ex        ey 
124.31727  39.86736 

[[59]]
      ex       ey 
124.3187  39.8686 

[[60]]
      ex       ey 
74.34230 31.54602 

[[61]]
      ex       ey 
74.34230 31.54602 

[[62]]
      ex       ey 
86.10037 19.88304 

[[63]]
      ex       ey 
57.08147 30.28389 

[[64]]
      ex       ey 
30.52925 50.44892 

[[65]]
        ex         ey 
-0.5499055 42.5480146 

[[66]]
       ex        ey 
 2.351628 48.857790 

[[67]]
       ex        ey 
 2.354752 48.864951 

[[68]]
       ex        ey 
 2.353321 48.859741 

[[69]]
      ex       ey 
42.70064 42.24135 

[[70]]
       ex        ey 
-5.672286 40.978441 

[[71]]
       ex        ey 
-1.642505 42.815643 

[[72]]
      ex       ey 
10.40099 63.42225 

[[73]]
      ex       ey 
13.34705 38.11055 

[[74]]
      ex       ey 
13.34364 38.10667 

[[75]]
      ex       ey 
13.35079 38.11602 

[[76]]
       ex        ey 
140.55599  39.30834 

[[77]]
      ex       ey 
-6.25987 53.34756 

[[78]]
       ex        ey 
119.36510  43.96304 

[[79]]
        ex         ey 
-0.3714739 49.1782577 

[[80]]
      ex       ey 
85.84589 20.26569 

[[81]]
      ex       ey 
47.69501 40.28188 

[[82]]
      ex       ey 
90.54986 23.54990 

[[83]]
      ex       ey 
90.55791 23.54270 

[[84]]
      ex       ey 
12.47713 41.88940 

[[85]]
      ex       ey 
12.48055 41.89328 

[[86]]
      ex       ey 
12.48310 41.89851 

[[87]]
      ex       ey 
69.26209 41.26832 

[[88]]
      ex       ey 
14.78343 41.13296 

[[89]]
      ex       ey 
14.78522 41.13240 

[[90]]
      ex       ey 
14.78338 41.13360 

[[91]]
      ex       ey 
14.78338 41.13371 

[[92]]
      ex       ey 
14.21398 41.10555 

[[93]]
      ex       ey 
14.21393 41.10601 

[[94]]
      ex       ey 
14.21576 41.10498 

[[95]]
      ex       ey 
14.21393 41.10612 

[[96]]
      ex       ey 
31.29492 51.50650 

[[97]]
      ex       ey 
30.52321 50.46285 

[[98]]
      ex       ey 
31.44475 50.07757 

[[99]]
      ex       ey 
28.83460 55.50076 

[[100]]
      ex       ey 
28.83505 55.50081 

[[101]]
      ex       ey 
28.83492 55.50052 

[[102]]
      ex       ey 
14.76827 40.68242 

[[103]]
      ex       ey 
14.76648 40.68298 

[[104]]
      ex       ey 
14.76657 40.68361 

[[105]]
      ex       ey 
14.76657 40.68372 

[[106]]
      ex       ey 
14.60419 40.63286 

[[107]]
      ex       ey 
14.60251 40.63400 

[[108]]
      ex       ey 
14.60251 40.63411 

[[109]]
      ex       ey 
14.60241 40.63342 

[[110]]
      ex       ey 
10.31640 50.41401 

[[111]]
      ex       ey 
37.15838 36.19492 

[[112]]
      ex       ey 
37.16345 36.20319 

[[113]]
      ex       ey 
37.15721 36.19728 

[[114]]
      ex       ey 
37.16357 36.21155 

[[115]]
      ex       ey 
37.16524 36.20172 

[[116]]
      ex       ey 
37.16616 36.21563 

[[117]]
      ex       ey 
36.28197 33.49188 

[[118]]
      ex       ey 
36.28704 33.50016 

[[119]]
      ex       ey 
36.28975 33.51259 

[[120]]
      ex       ey 
36.28080 33.49425 

[[121]]
      ex       ey 
36.28716 33.50852 

[[122]]
      ex       ey 
36.28883 33.49869 

[[123]]
      ex       ey 
58.78616 36.18036 

[[124]]
      ex       ey 
58.79419 36.18480 

[[125]]
      ex       ey 
58.79188 36.20328 

[[126]]
      ex       ey 
58.78733 36.17799 

[[127]]
      ex       ey 
58.79511 36.19870 

[[128]]
      ex       ey 
58.79240 36.18627 

[[129]]
      ex       ey 
58.79252 36.19463 

[[130]]
       ex        ey 
114.32287  34.79265 

[[131]]
        ex         ey 
104.725492  -3.030984 

[[132]]
      ex       ey 
29.71913 40.42853 

[[133]]
      ex       ey 
29.71896 40.43308 

[[134]]
      ex       ey 
29.72079 40.41869 

[[135]]
      ex       ey 
29.71277 40.41425 

[[136]]
      ex       ey 
29.71900 40.42017 

[[137]]
      ex       ey 
29.71393 40.41189 

[[138]]
      ex       ey 
29.72059 40.43081 

[[139]]
        ex         ey 
 0.1110128 38.8472724 

[[140]]
        ex         ey 
 0.1096057 38.8476884 

[[141]]
        ex         ey 
 0.1093839 38.8472291 

[[142]]
        ex         ey 
 0.6327349 41.6159327 

[[143]]
        ex         ey 
 0.6314628 41.6162983 

[[144]]
        ex         ey 
 0.6331021 41.6169273 

[[145]]
        ex         ey 
 0.6332753 41.6203903 

[[146]]
NULL

[[147]]
       ex        ey 
-2.996629 58.997677 

[[148]]
      ex       ey 
20.89867 45.69866 

[[149]]
      ex       ey 
10.10007 35.67825 

[[150]]
      ex       ey 
10.10007 35.67825 </code></pre>
</div>
<div class="sourceCode" id="cb74"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
